{"version":3,"file":"intelligentDataQualityService.js","sourceRoot":"","sources":["../../../server/services/intelligentDataQualityService.ts"],"names":[],"mappings":"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","sourcesContent":["import { storage } from '../storage';\r\nimport { nlpService } from './nlpService';\r\nimport type { RegulatoryUpdate, LegalCase } from '@shared/schema';\r\n\r\ninterface QualityMetrics {\r\n  completeness: number; // 0-1\r\n  accuracy: number; // 0-1\r\n  timeliness: number; // 0-1\r\n  relevance: number; // 0-1\r\n  consistency: number; // 0-1\r\n  overall: number; // 0-1\r\n}\r\n\r\ninterface DataQualityIssue {\r\n  id: string;\r\n  type: 'missing_data' | 'duplicate' | 'outdated' | 'inconsistent' | 'irrelevant' | 'formatting';\r\n  severity: 'high' | 'medium' | 'low';\r\n  description: string;\r\n  affectedRecords: string[];\r\n  suggestedAction: string;\r\n  autoFixable: boolean;\r\n}\r\n\r\ninterface QualityReport {\r\n  overallScore: number;\r\n  metrics: QualityMetrics;\r\n  issues: DataQualityIssue[];\r\n  recommendations: string[];\r\n  improvementActions: Array<{\r\n    action: string;\r\n    priority: 'high' | 'medium' | 'low';\r\n    impact: string;\r\n    effort: string;\r\n  }>;\r\n}\r\n\r\nexport class IntelligentDataQualityService {\r\n  \r\n  async assessDataQuality(): Promise<QualityReport> {\r\n    console.log('[Data Quality] Starting comprehensive data quality assessment...');\r\n\r\n    const [regulatoryUpdates, legalCases] = await Promise.all([\r\n      storage.getAllRegulatoryUpdates(),\r\n      storage.getAllLegalCases()\r\n    ]);\r\n\r\n    const issues: DataQualityIssue[] = [];\r\n    \r\n    // Analyze regulatory updates\r\n    const regulatoryIssues = await this.analyzeRegulatoryUpdates(regulatoryUpdates);\r\n    issues.push(...regulatoryIssues);\r\n\r\n    // Analyze legal cases\r\n    const legalIssues = await this.analyzeLegalCases(legalCases);\r\n    issues.push(...legalIssues);\r\n\r\n    // Calculate quality metrics\r\n    const metrics = this.calculateQualityMetrics(regulatoryUpdates, legalCases, issues);\r\n\r\n    // Generate recommendations\r\n    const recommendations = this.generateRecommendations(issues);\r\n\r\n    // Generate improvement actions\r\n    const improvementActions = this.generateImprovementActions(issues);\r\n\r\n    const report: QualityReport = {\r\n      overallScore: metrics.overall,\r\n      metrics,\r\n      issues,\r\n      recommendations,\r\n      improvementActions\r\n    };\r\n\r\n    console.log(`[Data Quality] Assessment complete. Overall score: ${(metrics.overall * 100).toFixed(1)}%`);\r\n    return report;\r\n  }\r\n\r\n  async performAutomaticCleanup(): Promise<{\r\n    fixedIssues: number;\r\n    skippedIssues: number;\r\n    details: string[];\r\n  }> {\r\n    console.log('[Data Quality] Starting automatic data cleanup...');\r\n\r\n    const qualityReport = await this.assessDataQuality();\r\n    const autoFixableIssues = qualityReport.issues.filter(issue => issue.autoFixable);\r\n    \r\n    let fixedCount = 0;\r\n    let skippedCount = 0;\r\n    const details: string[] = [];\r\n\r\n    for (const issue of autoFixableIssues) {\r\n      try {\r\n        const fixed = await this.fixIssue(issue);\r\n        if (fixed) {\r\n          fixedCount++;\r\n          details.push(`Fixed: ${issue.description}`);\r\n        } else {\r\n          skippedCount++;\r\n          details.push(`Skipped: ${issue.description} (could not auto-fix)`);\r\n        }\r\n      } catch (error) {\r\n        skippedCount++;\r\n        details.push(`Error fixing ${issue.description}: ${error}`);\r\n      }\r\n    }\r\n\r\n    console.log(`[Data Quality] Cleanup complete: ${fixedCount} fixed, ${skippedCount} skipped`);\r\n    return { fixedIssues: fixedCount, skippedIssues: skippedCount, details };\r\n  }\r\n\r\n  private async analyzeRegulatoryUpdates(updates: RegulatoryUpdate[]): Promise<DataQualityIssue[]> {\r\n    const issues: DataQualityIssue[] = [];\r\n\r\n    // Check for duplicates\r\n    const duplicates = this.findDuplicateUpdates(updates);\r\n    if (duplicates.length > 0) {\r\n      issues.push({\r\n        id: 'regulatory_duplicates',\r\n        type: 'duplicate',\r\n        severity: 'medium',\r\n        description: `Found ${duplicates.length} potential duplicate regulatory updates`,\r\n        affectedRecords: duplicates.map(d => d.id),\r\n        suggestedAction: 'Review and merge or remove duplicate entries',\r\n        autoFixable: false\r\n      });\r\n    }\r\n\r\n    // Check for missing essential fields\r\n    const missingFields = updates.filter(u => \r\n      !u.title || !u.content || !u.sourceId || !u.publishedAt\r\n    );\r\n    \r\n    if (missingFields.length > 0) {\r\n      issues.push({\r\n        id: 'regulatory_missing_fields',\r\n        type: 'missing_data',\r\n        severity: 'high',\r\n        description: `${missingFields.length} regulatory updates missing essential fields`,\r\n        affectedRecords: missingFields.map(u => u.id),\r\n        suggestedAction: 'Complete missing required fields',\r\n        autoFixable: false\r\n      });\r\n    }\r\n\r\n    // Check for outdated content\r\n    const cutoffDate = new Date();\r\n    cutoffDate.setFullYear(cutoffDate.getFullYear() - 2);\r\n    \r\n    const outdatedUpdates = updates.filter(u => \r\n      u.publishedAt && new Date(u.publishedAt) < cutoffDate\r\n    );\r\n\r\n    if (outdatedUpdates.length > 100) { // Only flag if significant amount\r\n      issues.push({\r\n        id: 'regulatory_outdated',\r\n        type: 'outdated',\r\n        severity: 'low',\r\n        description: `${outdatedUpdates.length} regulatory updates are over 2 years old`,\r\n        affectedRecords: outdatedUpdates.map(u => u.id),\r\n        suggestedAction: 'Consider archiving very old updates',\r\n        autoFixable: true\r\n      });\r\n    }\r\n\r\n    // Check for content quality\r\n    const poorContentUpdates = updates.filter(u => \r\n      u.content && u.content.length < 50\r\n    );\r\n\r\n    if (poorContentUpdates.length > 0) {\r\n      issues.push({\r\n        id: 'regulatory_poor_content',\r\n        type: 'missing_data',\r\n        severity: 'medium',\r\n        description: `${poorContentUpdates.length} regulatory updates have very short content`,\r\n        affectedRecords: poorContentUpdates.map(u => u.id),\r\n        suggestedAction: 'Enhance content with more detailed information',\r\n        autoFixable: false\r\n      });\r\n    }\r\n\r\n    return issues;\r\n  }\r\n\r\n  private async analyzeLegalCases(cases: LegalCase[]): Promise<DataQualityIssue[]> {\r\n    const issues: DataQualityIssue[] = [];\r\n\r\n    // Check for duplicates\r\n    const duplicates = this.findDuplicateCases(cases);\r\n    if (duplicates.length > 0) {\r\n      issues.push({\r\n        id: 'legal_duplicates',\r\n        type: 'duplicate',\r\n        severity: 'high',\r\n        description: `Found ${duplicates.length} potential duplicate legal cases`,\r\n        affectedRecords: duplicates.map(d => d.id),\r\n        suggestedAction: 'Review and merge or remove duplicate cases',\r\n        autoFixable: false\r\n      });\r\n    }\r\n\r\n    // Check for missing key information\r\n    const incompleteCases = cases.filter(c => \r\n      !c.caseTitle || !c.summary || !c.jurisdiction || c.keyIssues.length === 0\r\n    );\r\n\r\n    if (incompleteCases.length > 0) {\r\n      issues.push({\r\n        id: 'legal_incomplete',\r\n        type: 'missing_data',\r\n        severity: 'high',\r\n        description: `${incompleteCases.length} legal cases missing key information`,\r\n        affectedRecords: incompleteCases.map(c => c.id),\r\n        suggestedAction: 'Complete missing case details',\r\n        autoFixable: false\r\n      });\r\n    }\r\n\r\n    // Check for inconsistent jurisdiction formatting\r\n    const jurisdictionFormats = new Set(cases.map(c => c.jurisdiction).filter(Boolean));\r\n    const inconsistentJurisdictions = Array.from(jurisdictionFormats).filter(j => \r\n      j && (j.length > 10 || j.includes(',') || j.includes(';'))\r\n    );\r\n\r\n    if (inconsistentJurisdictions.length > 0) {\r\n      const affectedCases = cases.filter(c => \r\n        inconsistentJurisdictions.includes(c.jurisdiction)\r\n      );\r\n\r\n      issues.push({\r\n        id: 'legal_jurisdiction_format',\r\n        type: 'formatting',\r\n        severity: 'low',\r\n        description: `Inconsistent jurisdiction formatting in ${affectedCases.length} cases`,\r\n        affectedRecords: affectedCases.map(c => c.id),\r\n        suggestedAction: 'Standardize jurisdiction field format',\r\n        autoFixable: true\r\n      });\r\n    }\r\n\r\n    return issues;\r\n  }\r\n\r\n  private findDuplicateUpdates(updates: RegulatoryUpdate[]): RegulatoryUpdate[] {\r\n    const duplicates: RegulatoryUpdate[] = [];\r\n    const seen = new Map<string, RegulatoryUpdate>();\r\n\r\n    for (const update of updates) {\r\n      const key = `${update.title?.toLowerCase()}_${update.sourceId}`;\r\n      if (seen.has(key)) {\r\n        duplicates.push(update);\r\n      } else {\r\n        seen.set(key, update);\r\n      }\r\n    }\r\n\r\n    return duplicates;\r\n  }\r\n\r\n  private findDuplicateCases(cases: LegalCase[]): LegalCase[] {\r\n    const duplicates: LegalCase[] = [];\r\n    const seen = new Map<string, LegalCase>();\r\n\r\n    for (const case_ of cases) {\r\n      const key = `${case_.caseTitle?.toLowerCase()}_${case_.jurisdiction}`;\r\n      if (seen.has(key)) {\r\n        duplicates.push(case_);\r\n      } else {\r\n        seen.set(key, case_);\r\n      }\r\n    }\r\n\r\n    return duplicates;\r\n  }\r\n\r\n  private calculateQualityMetrics(\r\n    updates: RegulatoryUpdate[], \r\n    cases: LegalCase[], \r\n    issues: DataQualityIssue[]\r\n  ): QualityMetrics {\r\n    const totalRecords = updates.length + cases.length;\r\n    const highSeverityIssues = issues.filter(i => i.severity === 'high').length;\r\n    const mediumSeverityIssues = issues.filter(i => i.severity === 'medium').length;\r\n    const lowSeverityIssues = issues.filter(i => i.severity === 'low').length;\r\n\r\n    // Completeness: percentage of records with all required fields\r\n    const completeUpdates = updates.filter(u => \r\n      u.title && u.content && u.sourceId && u.publishedAt\r\n    ).length;\r\n    const completeCases = cases.filter(c => \r\n      c.caseTitle && c.summary && c.jurisdiction && c.keyIssues.length > 0\r\n    ).length;\r\n    const completeness = totalRecords > 0 ? (completeUpdates + completeCases) / totalRecords : 1;\r\n\r\n    // Accuracy: inverse of high-severity issues\r\n    const accuracy = Math.max(0, 1 - (highSeverityIssues / Math.max(totalRecords, 1)));\r\n\r\n    // Timeliness: percentage of recent content\r\n    const recentCutoff = new Date();\r\n    recentCutoff.setFullYear(recentCutoff.getFullYear() - 1);\r\n    const recentUpdates = updates.filter(u => \r\n      u.publishedAt && new Date(u.publishedAt) >= recentCutoff\r\n    ).length;\r\n    const recentCases = cases.filter(c => \r\n      c.decisionDate && new Date(c.decisionDate) >= recentCutoff\r\n    ).length;\r\n    const timeliness = totalRecords > 0 ? (recentUpdates + recentCases) / totalRecords : 1;\r\n\r\n    // Relevance: based on medical device keywords\r\n    const relevantUpdates = updates.filter(u => \r\n      this.isRelevantContent(u.content || '')\r\n    ).length;\r\n    const relevantCases = cases.filter(c => \r\n      this.isRelevantContent(c.summary || '')\r\n    ).length;\r\n    const relevance = totalRecords > 0 ? (relevantUpdates + relevantCases) / totalRecords : 1;\r\n\r\n    // Consistency: inverse of formatting and duplicate issues\r\n    const consistencyIssues = issues.filter(i => \r\n      i.type === 'duplicate' || i.type === 'formatting' || i.type === 'inconsistent'\r\n    ).length;\r\n    const consistency = Math.max(0, 1 - (consistencyIssues / Math.max(totalRecords, 1)));\r\n\r\n    // Overall score: weighted average\r\n    const overall = (\r\n      completeness * 0.25 +\r\n      accuracy * 0.3 +\r\n      timeliness * 0.15 +\r\n      relevance * 0.15 +\r\n      consistency * 0.15\r\n    );\r\n\r\n    return {\r\n      completeness,\r\n      accuracy,\r\n      timeliness,\r\n      relevance,\r\n      consistency,\r\n      overall\r\n    };\r\n  }\r\n\r\n  private isRelevantContent(content: string): boolean {\r\n    const medtechKeywords = [\r\n      'medical device', 'medizinprodukt', 'fda', 'ema', 'ce mark',\r\n      'clinical trial', 'regulatory', 'approval', 'clearance',\r\n      'recall', 'safety', 'biocompatibility', 'cybersecurity'\r\n    ];\r\n\r\n    const lowerContent = content.toLowerCase();\r\n    return medtechKeywords.some(keyword => lowerContent.includes(keyword));\r\n  }\r\n\r\n  private generateRecommendations(issues: DataQualityIssue[]): string[] {\r\n    const recommendations: string[] = [];\r\n\r\n    const highSeverityCount = issues.filter(i => i.severity === 'high').length;\r\n    const duplicateIssues = issues.filter(i => i.type === 'duplicate').length;\r\n    const missingDataIssues = issues.filter(i => i.type === 'missing_data').length;\r\n\r\n    if (highSeverityCount > 0) {\r\n      recommendations.push(`Prioritize fixing ${highSeverityCount} high-severity data quality issues`);\r\n    }\r\n\r\n    if (duplicateIssues > 0) {\r\n      recommendations.push('Implement automated duplicate detection to prevent future duplicates');\r\n    }\r\n\r\n    if (missingDataIssues > 0) {\r\n      recommendations.push('Enhance data collection processes to capture all required fields');\r\n    }\r\n\r\n    const autoFixableCount = issues.filter(i => i.autoFixable).length;\r\n    if (autoFixableCount > 0) {\r\n      recommendations.push(`${autoFixableCount} issues can be automatically fixed - consider running automated cleanup`);\r\n    }\r\n\r\n    recommendations.push('Establish regular data quality monitoring and alerts');\r\n    recommendations.push('Create data quality dashboards for ongoing monitoring');\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  private generateImprovementActions(issues: DataQualityIssue[]): Array<{\r\n    action: string;\r\n    priority: 'high' | 'medium' | 'low';\r\n    impact: string;\r\n    effort: string;\r\n  }> {\r\n    const actions = [];\r\n\r\n    if (issues.some(i => i.type === 'duplicate')) {\r\n      actions.push({\r\n        action: 'Implement automated duplicate detection',\r\n        priority: 'high' as const,\r\n        impact: 'Significantly reduces data redundancy and improves accuracy',\r\n        effort: 'Medium - requires development of similarity algorithms'\r\n      });\r\n    }\r\n\r\n    if (issues.some(i => i.type === 'missing_data')) {\r\n      actions.push({\r\n        action: 'Enhance data validation at input',\r\n        priority: 'high' as const,\r\n        impact: 'Prevents incomplete data from entering the system',\r\n        effort: 'Low - add validation rules to forms and APIs'\r\n      });\r\n    }\r\n\r\n    if (issues.some(i => i.type === 'formatting')) {\r\n      actions.push({\r\n        action: 'Standardize data formats and create data dictionaries',\r\n        priority: 'medium' as const,\r\n        impact: 'Improves data consistency and searchability',\r\n        effort: 'Medium - requires defining standards and updating existing data'\r\n      });\r\n    }\r\n\r\n    if (issues.some(i => i.type === 'outdated')) {\r\n      actions.push({\r\n        action: 'Implement automated archiving for old content',\r\n        priority: 'low' as const,\r\n        impact: 'Improves system performance and focuses on recent content',\r\n        effort: 'Low - simple date-based rules'\r\n      });\r\n    }\r\n\r\n    actions.push({\r\n      action: 'Set up automated data quality monitoring',\r\n      priority: 'medium' as const,\r\n      impact: 'Enables proactive identification of quality issues',\r\n      effort: 'Medium - requires setting up monitoring infrastructure'\r\n    });\r\n\r\n    return actions;\r\n  }\r\n\r\n  private async fixIssue(issue: DataQualityIssue): Promise<boolean> {\r\n    switch (issue.type) {\r\n      case 'outdated':\r\n        // Archive very old content\r\n        return await this.archiveOldContent(issue.affectedRecords);\r\n        \r\n      case 'formatting':\r\n        // Fix common formatting issues\r\n        return await this.fixFormattingIssues(issue.affectedRecords);\r\n        \r\n      default:\r\n        return false; // Cannot auto-fix this type\r\n    }\r\n  }\r\n\r\n  private async archiveOldContent(recordIds: string[]): Promise<boolean> {\r\n    try {\r\n      // Implementation would depend on your archiving strategy\r\n      console.log(`[Data Quality] Would archive ${recordIds.length} old records`);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[Data Quality] Error archiving old content:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private async fixFormattingIssues(recordIds: string[]): Promise<boolean> {\r\n    try {\r\n      // Implementation would fix common formatting issues\r\n      console.log(`[Data Quality] Would fix formatting for ${recordIds.length} records`);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[Data Quality] Error fixing formatting:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nexport const intelligentDataQualityService = new IntelligentDataQualityService();"]}