import{u as K,r as V,g as Q,h as b,j as e,o as G,p as H,B as p,q as L,s as O,t as $,O as J,I as y,w as v,x as f,y as N,z as S,E as s,C,a as A,b as w,J as E,P as F,c as q,G as M,k as W,Q as l,R as T}from"./index-Dm22qi9h.js";import{u as X,F as Z,a as c,b as d,c as o,d as u,e as g,f as Y,t as _,o as ee,g as ae,s as i}from"./types--AxGqAm3.js";import{S as U}from"./switch-CWNsPlWW.js";import{P as se}from"./plus-gaIGr6ZR.js";import{C as ne}from"./circle-x-hHiG2my6.js";const re=ee({name:i().min(1,"Name ist erforderlich"),type:i().min(1,"Typ ist erforderlich"),endpoint:i().url("Gültige URL erforderlich").optional(),region:i().min(1,"Region ist erforderlich"),country:i().optional(),category:i().min(1,"Kategorie ist erforderlich"),language:i().default("en"),syncFrequency:i().default("daily"),isActive:ae().default(!0)}),te=[{name:"BfArM",region:"DE",country:"Germany",category:"regulations",type:"bfarm",language:"de"},{name:"DIN Standards",region:"DE",country:"Germany",category:"standards",type:"standards",language:"de"},{name:"EMA Medicines",region:"EU",category:"regulations",type:"ema",language:"en"},{name:"EUR-Lex",region:"EU",category:"rulings",type:"legal",language:"en"},{name:"CEN Standards",region:"EU",category:"standards",type:"standards",language:"en"},{name:"Swissmedic",region:"CH",country:"Switzerland",category:"regulations",type:"swissmedic",language:"de"},{name:"MHRA",region:"UK",country:"United Kingdom",category:"regulations",type:"mhra",language:"en"},{name:"BSI Standards",region:"UK",country:"United Kingdom",category:"standards",type:"standards",language:"en"},{name:"FDA Devices",region:"US",country:"United States",category:"approvals",type:"fda",language:"en"},{name:"NIST Standards",region:"US",country:"United States",category:"standards",type:"standards",language:"en"},{name:"PMDA Japan",region:"JP",country:"Japan",category:"regulations",type:"pmda",language:"ja"},{name:"NMPA China",region:"CN",country:"China",category:"regulations",type:"nmpa",language:"zh"},{name:"CDSCO India",region:"IN",country:"India",category:"regulations",type:"cdsco",language:"en"},{name:"Roszdravnadzor",region:"RU",country:"Russia",category:"regulations",type:"roszdravnadzor",language:"ru"},{name:"ANVISA Brazil",region:"BR",country:"Brazil",category:"regulations",type:"anvisa",language:"pt"},{name:"ANMAT Argentina",region:"AR",country:"Argentina",category:"regulations",type:"anmat",language:"es"}];function ue(){const{toast:h}=K(),[R,m]=V.useState(!1),{data:z=[],isLoading:P}=Q({queryKey:["/api/data-sources"]}),r=X({resolver:_(re),defaultValues:{language:"en",syncFrequency:"daily",isActive:!0}}),x=b({mutationFn:async a=>T("/api/data-sources","POST",a),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/data-sources"]}),m(!1),r.reset(),h({title:"Datenquelle hinzugefügt",description:"Die neue Datenquelle wurde erfolgreich erstellt."})},onError:a=>{h({title:"Fehler",description:"Fehler beim Erstellen der Datenquelle.",variant:"destructive"})}}),D=b({mutationFn:async({id:a,isActive:n})=>(console.log(`Toggling ${a} to ${n}`),T(`/api/data-sources/${a}`,"PATCH",{isActive:n})),onMutate:async({id:a,isActive:n})=>{await l.cancelQueries({queryKey:["/api/data-sources"]});const t=l.getQueryData(["/api/data-sources"]);return l.setQueryData(["/api/data-sources"],(B=[])=>B.map(j=>j.id===a?{...j,isActive:n}:j)),{previousDataSources:t}},onError:(a,n,t)=>{t!=null&&t.previousDataSources&&l.setQueryData(["/api/data-sources"],t.previousDataSources),h({title:"Fehler beim Toggle",description:"Status konnte nicht geändert werden.",variant:"destructive"})},onSuccess:(a,{id:n,isActive:t})=>{console.log(`Toggle successful for ${n}:`,a),h({title:"Datenquelle aktualisiert",description:`${t?"Aktiviert":"Deaktiviert"}`})},onSettled:()=>{l.invalidateQueries({queryKey:["/api/data-sources"]}),l.invalidateQueries({queryKey:["/api/sync/stats"]})}}),k=a=>{r.reset({name:a.name,type:a.type,region:a.region,country:a.country,category:a.category,language:a.language,syncFrequency:"daily",isActive:!0}),m(!0)},I=a=>{x.mutate(a)};return P?e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4,5,6].map(a=>e.jsx("div",{className:"h-48 bg-muted rounded"},a))})]})}):e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Datenquellen-Verwaltung"}),e.jsx("p",{className:"text-muted-foreground",children:"Verwaltung weltweiter regulatorischer Datenquellen für MedTech-Compliance"})]}),e.jsxs(G,{open:R,onOpenChange:m,children:[e.jsx(H,{asChild:!0,children:e.jsxs(p,{children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Datenquelle hinzufügen"]})}),e.jsxs(L,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx($,{children:"Neue Datenquelle"}),e.jsx(J,{children:"Fügen Sie eine neue regulatorische Datenquelle hinzu."})]}),e.jsx(Z,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(I),className:"space-y-4",children:[e.jsx(c,{control:r.control,name:"name",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"Name"}),e.jsx(u,{children:e.jsx(y,{placeholder:"z.B. BfArM Deutschland",...a})}),e.jsx(g,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{control:r.control,name:"type",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"Typ"}),e.jsxs(v,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(u,{children:e.jsx(f,{children:e.jsx(N,{placeholder:"Typ wählen"})})}),e.jsxs(S,{children:[e.jsx(s,{value:"fda",children:"FDA"}),e.jsx(s,{value:"ema",children:"EMA"}),e.jsx(s,{value:"bfarm",children:"BfArM"}),e.jsx(s,{value:"swissmedic",children:"Swissmedic"}),e.jsx(s,{value:"mhra",children:"MHRA"}),e.jsx(s,{value:"pmda",children:"PMDA"}),e.jsx(s,{value:"nmpa",children:"NMPA"}),e.jsx(s,{value:"anvisa",children:"ANVISA"}),e.jsx(s,{value:"standards",children:"Standards"}),e.jsx(s,{value:"legal",children:"Rechtsprechung"})]})]}),e.jsx(g,{})]})}),e.jsx(c,{control:r.control,name:"category",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"Kategorie"}),e.jsxs(v,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(u,{children:e.jsx(f,{children:e.jsx(N,{placeholder:"Kategorie"})})}),e.jsxs(S,{children:[e.jsx(s,{value:"regulations",children:"Regulierungen"}),e.jsx(s,{value:"standards",children:"Standards"}),e.jsx(s,{value:"rulings",children:"Rechtsprechung"}),e.jsx(s,{value:"approvals",children:"Zulassungen"})]})]}),e.jsx(g,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{control:r.control,name:"region",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"Region"}),e.jsx(u,{children:e.jsx(y,{placeholder:"z.B. DE, EU, US",...a})}),e.jsx(g,{})]})}),e.jsx(c,{control:r.control,name:"language",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"Sprache"}),e.jsxs(v,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(u,{children:e.jsx(f,{children:e.jsx(N,{})})}),e.jsxs(S,{children:[e.jsx(s,{value:"de",children:"Deutsch"}),e.jsx(s,{value:"en",children:"English"}),e.jsx(s,{value:"fr",children:"Français"}),e.jsx(s,{value:"es",children:"Español"}),e.jsx(s,{value:"pt",children:"Português"}),e.jsx(s,{value:"zh",children:"中文"}),e.jsx(s,{value:"ja",children:"日本語"}),e.jsx(s,{value:"ru",children:"Русский"})]})]}),e.jsx(g,{})]})})]}),e.jsx(c,{control:r.control,name:"endpoint",render:({field:a})=>e.jsxs(d,{children:[e.jsx(o,{children:"API Endpoint (optional)"}),e.jsx(u,{children:e.jsx(y,{placeholder:"https://api.example.com",...a})}),e.jsx(g,{})]})}),e.jsx(c,{control:r.control,name:"isActive",render:({field:a})=>e.jsxs(d,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Aktiv"}),e.jsx(Y,{children:"Automatische Datensammlung aktivieren"})]}),e.jsx(u,{children:e.jsx(U,{checked:a.value,onCheckedChange:a.onChange})})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{variant:"outline",type:"button",onClick:()=>m(!1),children:"Abbrechen"}),e.jsx(p,{type:"submit",disabled:x.isPending,children:x.isPending?"Wird erstellt...":"Erstellen"})]})]})})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vordefinierte globale Quellen"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:te.map((a,n)=>e.jsxs(C,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>k(a),children:[e.jsxs(A,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{className:"text-lg",children:a.name}),e.jsx(E,{variant:"outline",children:a.region})]}),e.jsxs(F,{children:[a.category," • ",a.country]})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),a.language.toUpperCase()]})})]},n))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Konfigurierte Datenquellen"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:z.map(a=>{var n;return e.jsxs(C,{children:[e.jsxs(A,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{className:"text-lg",children:a.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{variant:"outline",children:a.region}),a.isActive?e.jsx(W,{className:"h-4 w-4 text-green-600"}):e.jsx(ne,{className:"h-4 w-4 text-red-600"})]})]}),e.jsxs(F,{children:[a.category," • ",a.type]})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),((n=a.language)==null?void 0:n.toUpperCase())||"EN"]}),e.jsx(U,{checked:a.isActive||!1,onCheckedChange:t=>D.mutate({id:a.id,isActive:t}),disabled:D.isPending})]}),a.lastSyncAt&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Letzte Synchronisation: ",new Date(a.lastSyncAt).toLocaleDateString("de-DE")]})]})]},a.id)})})]})]})}export{ue as default};
