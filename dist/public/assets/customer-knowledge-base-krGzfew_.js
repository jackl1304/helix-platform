import{r as n,ap as K,U as P,g as F,j as e,aI as y,C as d,a as w,b as S,ag as C,c as o,I as U,w as g,x as j,y as f,z as v,E as a,J as p,P as V,G as Q,B as W,a0 as q}from"./index-Dm22qi9h.js";import{C as k}from"./customer-navigation-B5k3fS1T.js";import{u as G}from"./use-live-tenant-permissions-XuPhfx9r.js";import{C as H}from"./calendar-B2qkWIGY.js";import"./clipboard-anxMjb0Z.js";const J="030d3e01-32c4-4f95-8d54-98be948e8d4b";function le(){const[O,Z]=n.useState(null),[r,A]=n.useState(""),[t,L]=n.useState("all"),[i,B]=n.useState("all"),[c,I]=n.useState("all"),N=K().tenantId||J,{t:T}=P(),{permissions:D,tenantName:b,isLoading:E}=G({tenantId:N,pollInterval:3e3}),l=D||{dashboard:!0,regulatoryUpdates:!0,legalCases:!0,knowledgeBase:!0,newsletters:!1,analytics:!1,reports:!1,dataCollection:!1,globalSources:!1,historicalData:!1,administration:!1,userManagement:!1,systemSettings:!1,auditLogs:!1,aiInsights:!1,advancedAnalytics:!1},{data:m,isLoading:R,error:X}=F({queryKey:["/api/knowledge-articles",N],queryFn:async()=>{const s=await fetch("/api/knowledge-articles");if(!s.ok)throw new Error("Failed to fetch knowledge articles");return await s.json()},enabled:!!(l!=null&&l.knowledgeBase),staleTime:3e5}),x=n.useMemo(()=>m?m.filter(s=>{const h=s.title.toLowerCase().includes(r.toLowerCase())||s.content.toLowerCase().includes(r.toLowerCase()),u=t==="all"||s.category===t,M=i==="all"||s.region===i,z=c==="all"||s.authority===c;return h&&u&&M&&z}):[],[m,r,t,i,c]);return E?e.jsx("div",{className:"flex h-screen bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):l!=null&&l.knowledgeBase?e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(y,{})}),e.jsx(k,{permissions:l,tenantName:b||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Wissensdatenbank"}),e.jsx("p",{className:"text-gray-600",children:"Umfassende Sammlung von Artikeln und Dokumenten zur Medizinprodukte-Regulierung"})]}),e.jsx(d,{className:"mb-6",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx("div",{children:e.jsx(U,{placeholder:"Suche nach Artikeln...",value:r,onChange:s=>A(s.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(g,{value:t,onValueChange:L,children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Kategorie"})}),e.jsxs(v,{children:[e.jsx(a,{value:"all",children:"Alle Kategorien"}),e.jsx(a,{value:"regulation",children:"Regulierung"}),e.jsx(a,{value:"guidance",children:"Leitf채den"}),e.jsx(a,{value:"standards",children:"Standards"}),e.jsx(a,{value:"compliance",children:"Compliance"})]})]})}),e.jsx("div",{children:e.jsxs(g,{value:i,onValueChange:B,children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Region"})}),e.jsxs(v,{children:[e.jsx(a,{value:"all",children:"Alle Regionen"}),e.jsx(a,{value:"eu",children:"Europa"}),e.jsx(a,{value:"usa",children:"USA"}),e.jsx(a,{value:"asia",children:"Asien"})]})]})}),e.jsx("div",{children:e.jsxs(g,{value:c,onValueChange:I,children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Quelle"})}),e.jsxs(v,{children:[e.jsx(a,{value:"all",children:"Alle Quellen"}),e.jsx(a,{value:"FDA",children:"FDA"}),e.jsx(a,{value:"EMA",children:"EMA"}),e.jsx(a,{value:"BfArM",children:"BfArM"})]})]})})]})})}),R?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsxs("div",{className:"bg-white rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"})]},s))}):x&&x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>e.jsxs(d,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(w,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(S,{className:"text-lg font-semibold line-clamp-2",children:s.title}),e.jsx(p,{variant:s.priority==="high"?"destructive":"default",children:s.priority})]}),e.jsx(V,{className:"line-clamp-3",children:s.summary||s.content.substring(0,150)+"..."})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:s.region})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.published_at).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{variant:"outline",children:s.category}),e.jsxs(W,{variant:"outline",size:"sm",children:[e.jsx(q,{className:"w-4 h-4 mr-1"}),"Lesen"]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:s.tags.slice(0,3).map((h,u)=>e.jsx(p,{variant:"outline",className:"text-xs",children:h},u))})]})]},s.id))}):e.jsx(d,{children:e.jsxs(o,{className:"text-center py-12",children:[e.jsx(C,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Artikel verf체gbar"}),e.jsx("p",{className:"text-gray-500",children:r||t!=="all"||i!=="all"||c!=="all"?"Ihre Suchkriterien ergaben keine Treffer.":"Aktuell sind keine Wissensdatenbank-Artikel vorhanden."})]})})]})})]}):e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(y,{})}),e.jsx(k,{permissions:l,tenantName:b||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 flex items-center justify-center",children:e.jsxs(d,{className:"max-w-md",children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),T("access.restricted")]})}),e.jsx(o,{children:e.jsx("p",{className:"text-muted-foreground",children:"Sie haben keine Berechtigung f체r den Zugriff auf die Wissensdatenbank. Kontaktieren Sie Ihren Administrator f체r weitere Informationen."})})]})})]})}export{le as default};
