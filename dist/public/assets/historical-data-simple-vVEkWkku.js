import{r as f,g as N,j as e,C as l,a as i,b as c,D as v,c as d,a0 as b,T as w,P as k,J as r,B as m,M as D}from"./index-Dm22qi9h.js";import{P as C}from"./pdf-download-button-EViB0A4J.js";import{C as p}from"./calendar-B2qkWIGY.js";import{E as _}from"./eye-KEHLO33x.js";import"./download-CQfvf7I6.js";function z(){const[x,y]=f.useState(""),{data:t=[],isLoading:h,error:u}=N({queryKey:["/api/historical/data"],staleTime:3e4,gcTime:6e4,refetchOnMount:!0}),n=t.filter(s=>{var o,j,g;if(!x)return!0;const a=x.toLowerCase();return((o=s.title)==null?void 0:o.toLowerCase().includes(a))||((j=s.description)==null?void 0:j.toLowerCase().includes(a))||((g=s.source_id)==null?void 0:g.toLowerCase().includes(a))});return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Historische Daten"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Umfassende Sammlung regulatorischer Dokumente und Änderungsverfolgung"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Gesamte Dokumente"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Historische Einträge"})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Gefilterte Ergebnisse"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Angezeigte Dokumente"})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Letzte Aktualisierung"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Heute"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatische Synchronisation"})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Status"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Aktiv"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"System läuft optimal"})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Dokumente durchsuchen...",value:x,onChange:s=>y(s.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})}),h&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"Lade historische Dokumente..."})]}),u&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-red-600 dark:text-red-400",children:"Fehler beim Laden der Daten"})}),!h&&!u&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Dokumentenarchiv"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:[n.length," von ",t.length," Dokumenten"]}),e.jsx("div",{className:"grid gap-4",children:n.map(s=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx(c,{className:"text-lg",children:s.title||s.documentTitle}),e.jsx(k,{className:"mt-1",children:s.description||s.summary||"Keine Beschreibung verfügbar"}),s.region&&e.jsx(r,{variant:"secondary",className:"mt-2 mr-2",children:s.region}),s.category&&e.jsx(r,{variant:"outline",className:"mt-2",children:s.category})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(r,{variant:"outline",children:s.source_id||s.sourceId}),s.priority&&e.jsx(r,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"default":"secondary",children:s.priority})]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(p,{className:"h-4 w-4 mr-1"}),(()=>{try{const a=new Date(s.published_at||s.originalDate);return isNaN(a.getTime())?(s.published_at||s.originalDate||"Unbekannt").split("T")[0]:a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Unbekannt"}})()]}),s.change_type&&e.jsx(r,{variant:"secondary",children:s.change_type}),s.version&&e.jsxs(r,{variant:"outline",children:["v",s.version]}),s.language&&e.jsx(r,{variant:"outline",children:s.language})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Dokument-Details"}),s.document_url&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Quelle:"})," ",e.jsx("span",{className:"text-blue-600 truncate",children:s.document_url})]}),s.archived_at&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Archiviert:"})," ",new Date(s.archived_at).toLocaleDateString("de-DE")]}),s.source_type&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Typ:"})," ",s.source_type]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Dokument-ID:"})," ",s.id]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Technische Daten"}),s.deviceClasses&&s.deviceClasses.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Geräteklassen:"})," ",s.deviceClasses.join(", ")]}),s.categories&&typeof s.categories=="object"&&Object.keys(s.categories).length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Kategorien:"})," ",Object.entries(s.categories).map(([a,o])=>`${a}: ${o}`).join(", ")]}),s.priority&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Priorität:"}),e.jsx(r,{variant:s.priority==="high"?"destructive":"secondary",className:"ml-2",children:s.priority})]})]})]}),(s.content||s.summary)&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Vollständiger Inhalt"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap max-h-40 overflow-y-auto",children:s.content||s.summary})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex space-x-2",children:[s.document_url&&e.jsx(m,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:s.document_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Original"]})}),e.jsx(C,{type:"historical-document",id:s.id,title:`PDF herunterladen: ${s.title}`,variant:"outline",size:"sm"}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>window.open(`/api/historical/document/${s.id}/view`,"_blank"),children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),"Vollansicht"]})]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(s,null,2)),alert("Alle Daten in Zwischenablage kopiert!")},children:"Alle Daten kopieren"})]})]})})]},s.id))}),n.length===0&&t.length>0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Keine Dokumente entsprechen den Suchkriterien"})}),n.length===0&&t.length===0&&!h&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Keine historischen Daten verfügbar"})})]})]})}export{z as default};
