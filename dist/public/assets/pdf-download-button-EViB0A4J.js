import{r as F,u as P,j as o,B as x,L}from"./index-Dm22qi9h.js";import{D as $}from"./download-CQfvf7I6.js";function v({type:w,id:e,title:h,variant:m="outline",size:l="sm",className:f="",showText:D=!0}){const[a,i]=F.useState(!1),{toast:r}=P(),g=()=>{switch(w){case"regulatory-update":return`/api/regulatory-updates/${e}/download`;case"legal-case":return`/api/legal-cases/${e}/download`;case"article":return`/api/articles/${e}/download`;case"historical-document":return`/api/historical/document/${e}/download`;case"newsletter":return`/api/newsletters/${e}/download`;case"knowledge-article":return`/api/knowledge-articles/${e}/download`;default:return null}},y=async()=>{const c=g();if(!c){r({title:"Fehler",description:"PDF-Download für diesen Typ nicht verfügbar",variant:"destructive"});return}i(!0);try{const t=await fetch(c,{method:"GET",headers:{Accept:"application/pdf","Content-Type":"application/pdf"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const d=t.headers.get("content-disposition");let s=`helix-document-${e}.pdf`;if(d){const u=d.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);u&&(s=u[1].replace(/['"]/g,""))}const b=await t.blob(),p=window.URL.createObjectURL(new Blob([b],{type:"application/pdf"})),n=document.createElement("a");n.href=p,n.download=s,n.style.display="none",document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(p)},100),r({title:"Download gestartet",description:`PDF "${s}" wird heruntergeladen.`})}catch(t){console.error("PDF Download Error:",t),r({title:"Download-Fehler",description:"PDF konnte nicht heruntergeladen werden.",variant:"destructive"})}finally{i(!1)}};return o.jsxs(x,{variant:m,size:l,className:f,onClick:y,disabled:a,title:h||"PDF herunterladen",children:[a?o.jsx(L,{className:"h-4 w-4 animate-spin"}):o.jsx($,{className:"h-4 w-4"}),D&&l!=="icon"&&o.jsx("span",{className:"ml-2",children:a?"Lädt...":"PDF"})]})}export{v as P};
