import{e as B,r as o,a3 as Z,j as e,K as q,u as P,B as l,a4 as F,M as S,f as H,g as Q,h as O,a5 as M,o as $,p as W,q as J,s as _,t as X,I as R,a6 as Y,w as L,x as U,y as G,z,E as j,C as w,a as ee,b as se,Z as te,P as ae,c as k,a7 as re,a8 as le,a9 as ne,l as ie,m as ce,n as N,H as b,a0 as de,J as C,G as oe,V as he,k as ue}from"./index-Dm22qi9h.js";import{P as K}from"./plus-gaIGr6ZR.js";import{C as xe}from"./calendar-B2qkWIGY.js";import{S as V}from"./square-pen-BRq2if-8.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=B("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=B("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function ge({type:r,itemId:i,title:n,compact:x=!1}){const[c,d]=o.useState(!1),[a,h]=o.useState(null),[m,A]=o.useState(!1),{toast:g}=P(),y=async()=>{d(!0);try{const u=`/api/pieces/share/${r}`,s=await(await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r==="regulatory"?{updateId:i}:r==="legal"?{caseId:i}:{newsletterId:i})})).json();if(s.success&&s.shareUrl){h(s.shareUrl),A(!0);try{await navigator.clipboard.writeText(s.shareUrl),g({title:"✅ Erfolgreich geteilt",description:`"${n}" wurde über Pieces geteilt und Link in Zwischenablage kopiert.`})}catch{g({title:"✅ Erfolgreich geteilt",description:`"${n}" wurde über Pieces geteilt: ${s.shareUrl}`})}}else throw new Error(s.error||"Teilen fehlgeschlagen")}catch(u){console.error("Fehler beim Teilen:",u),g({title:"❌ Fehler beim Teilen",description:u instanceof Error?u.message:"Pieces API nicht verfügbar",variant:"destructive"})}finally{d(!1)}},p=()=>{a&&window.open(a,"_blank")};return x?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:y,disabled:c,className:"px-2 py-1",children:c?e.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):m?e.jsx(F,{className:"w-3 h-3 text-green-600"}):e.jsx(I,{className:"w-3 h-3"})}),a&&e.jsx(l,{size:"sm",variant:"outline",onClick:p,className:"px-2 py-1",children:e.jsx(S,{className:"w-3 h-3"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{onClick:y,disabled:c,variant:m?"default":"outline",className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Teile..."]}):m?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"}),"Geteilt"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4"}),"Über Pieces teilen"]})}),a&&e.jsxs(l,{onClick:p,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Öffnen"]})]})}function pe(){const[r,i]=o.useState(null),[n,x]=o.useState(!1),c=async()=>{x(!0);try{const a=await(await fetch("/api/pieces/health")).json();i(a)}catch{i({healthy:!1,status:"Error"})}finally{x(!1)}};return Z.useEffect(()=>{c()},[]),n?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),"Prüfe Pieces API..."]}):r?e.jsx("div",{className:"flex items-center gap-2 text-sm",children:r.healthy?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-green-600",children:"Pieces API verfügbar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-3 h-3 text-yellow-500"}),e.jsx("span",{className:"text-yellow-600",children:"Pieces API nicht verfügbar"})]})}):null}function je(){const[r,i]=o.useState(!1),[n,x]=o.useState(null),{toast:c}=P(),d=async()=>{i(!0);try{const h=await(await fetch("/api/pieces/auto-share",{method:"POST",headers:{"Content-Type":"application/json"}})).json();x(h),c({title:"🚀 Automatisches Teilen abgeschlossen",description:h.message})}catch{c({title:"❌ Fehler beim automatischen Teilen",description:"Pieces API nicht verfügbar oder Fehler aufgetreten",variant:"destructive"})}finally{i(!1)}};return e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{onClick:d,disabled:r,variant:"outline",className:"w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),"Teile kritische Updates..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Kritische Updates automatisch teilen"]})}),n&&e.jsxs("div",{className:"text-sm text-center text-gray-600 bg-gray-50 p-3 rounded",children:["✅ ",n.message]})]})}function ve(){const[r,i]=o.useState(""),[n,x]=o.useState("all"),[c,d]=o.useState(!1),[a,h]=o.useState({subject:"",content:"",status:"draft"}),{toast:m}=P(),A=H(),{data:g=[],isLoading:y}=Q({queryKey:["newsletters"],queryFn:async()=>[{id:"nl-001",subject:"Weekly MedTech Regulatory Updates - KW 32",content:`# Helix Regulatory Intelligence Weekly

## 🚨 Kritische Updates diese Woche

**FDA 510(k) Clearances**
- CardioSense Monitoring System: Neue Herzüberwachungstechnologie zugelassen
- NeuroLink Implant V3: Erweiterte Gehirn-Computer-Schnittstelle genehmigt

**EU MDR Updates**
- Neue Klassifizierungsrichtlinien für KI-basierte Diagnostikgeräte
- Verlängerte Übergangsfristen für Klasse IIa Geräte

**Rechtsprechung**
- BGH-Urteil zur Produkthaftung bei KI-Medizinprodukten
- FDA vs. NeuraTech: $2.3M Strafe wegen unzureichender klinischer Daten

## 📊 Marktanalyse
Die regulatorische Landschaft zeigt verstärkte Fokussierung auf KI-Sicherheit und Interoperabilität...`,status:"sent",sentAt:"2025-08-07T10:00:00Z",recipientCount:847,extractedArticles:[{title:"FDA 510(k) CardioSense Approval",type:"regulatory"},{title:"EU MDR AI Classification Guidelines",type:"regulatory"},{title:"BGH Medical AI Liability Ruling",type:"legal"}],sources:[{name:"FDA Database",url:"https://www.fda.gov/510k"},{name:"EUR-Lex",url:"https://eur-lex.europa.eu"}],createdAt:"2025-08-05T14:30:00Z"},{id:"nl-002",subject:"Emergency Alert: Critical Device Recalls",content:`# 🚨 NOTFALL-NEWSLETTER - Sofortige Maßnahmen erforderlich

## Class I Recalls - Immediate Action Required

**MediCorp Insulin Pumps (Model X200-X250)**
- Recall-Nummer: Z-2024-003
- Betroffene Geräte: ca. 15.000 Einheiten weltweit
- Problem: Software-Fehler kann zu Überdosierung führen

**Sofortige Maßnahmen:**
1. Geräte sofort außer Betrieb nehmen
2. Patienten unverzüglich kontaktieren
3. Alternative Therapie einleiten

## Rechtliche Auswirkungen
- FDA verhängt $5.2M Strafe gegen MediCorp
- Zivilklagen bereits eingereicht
- EU-Marktüberwachung startet Untersuchung`,status:"sent",sentAt:"2025-08-06T15:45:00Z",recipientCount:1205,extractedArticles:[{title:"MediCorp Insulin Pump Recall Class I",type:"recall"},{title:"FDA MediCorp Penalty $5.2M",type:"enforcement"}],sources:[{name:"FDA Recalls",url:"https://www.fda.gov/safety/recalls"},{name:"EMA Safety Updates",url:"https://www.ema.europa.eu"}],createdAt:"2025-08-06T14:00:00Z"},{id:"nl-003",subject:"Draft: Quarterly Compliance Review Q3 2025",content:`# Quarterly MedTech Compliance Review - Q3 2025
## Draft Version - Internal Review

**Geplante Inhalte:**
- MDR Compliance Status Update
- FDA 510(k) Processing Times
- New ISO 14155:2025 Requirements
- AI/ML Validation Guidelines

**Status:** Wird überarbeitet
**Geplanter Versand:** 15. August 2025`,status:"draft",recipientCount:0,createdAt:"2025-08-07T09:15:00Z"}]}),p=O({mutationFn:async s=>{const t=await fetch("/api/newsletters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to create newsletter");return t.json()},onSuccess:()=>{A.invalidateQueries({queryKey:["newsletters"]}),d(!1),h({subject:"",content:"",status:"draft"}),m({title:"✅ Newsletter erstellt",description:"Der neue Newsletter wurde erfolgreich erstellt."})},onError:s=>{m({title:"❌ Fehler",description:"Newsletter konnte nicht erstellt werden.",variant:"destructive"})}}),u=g.filter(s=>{const t=s.subject.toLowerCase().includes(r.toLowerCase())||s.content.toLowerCase().includes(r.toLowerCase()),v=n==="all"||s.status===n;return t&&v}),E=s=>{switch(s){case"sent":return e.jsxs(C,{className:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),"Gesendet"]});case"draft":return e.jsxs(C,{className:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Entwurf"]});case"scheduled":return e.jsxs(C,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Geplant"]});default:return null}},D=async s=>{try{await navigator.clipboard.writeText(s),m({title:"✅ Kopiert",description:"Newsletter-Inhalt in Zwischenablage kopiert."})}catch{m({title:"❌ Fehler",description:"Kopieren fehlgeschlagen.",variant:"destructive"})}};return y?e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),e.jsx("div",{className:"grid gap-4",children:[...Array(3)].map((s,t)=>e.jsx("div",{className:"h-40 bg-gray-200 dark:bg-gray-700 rounded"},t))})]})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3",children:[e.jsx(M,{className:"w-8 h-8"}),"Newsletter Management"]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:[u.length," von ",g.length," Newslettern • Pieces-Integration aktiv"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(pe,{}),e.jsxs($,{open:c,onOpenChange:d,children:[e.jsx(W,{asChild:!0,children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Neuer Newsletter"]})}),e.jsxs(J,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(_,{children:e.jsx(X,{children:"Neuen Newsletter erstellen"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Betreff"}),e.jsx(R,{value:a.subject,onChange:s=>h(t=>({...t,subject:s.target.value})),placeholder:"Newsletter-Betreff eingeben..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Inhalt"}),e.jsx(Y,{value:a.content,onChange:s=>h(t=>({...t,content:s.target.value})),placeholder:"Newsletter-Inhalt eingeben...",rows:15})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),e.jsxs(L,{value:a.status,onValueChange:s=>h(t=>({...t,status:s})),children:[e.jsx(U,{children:e.jsx(G,{})}),e.jsxs(z,{children:[e.jsx(j,{value:"draft",children:"Entwurf"}),e.jsx(j,{value:"scheduled",children:"Geplant"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(l,{variant:"outline",onClick:()=>d(!1),children:"Abbrechen"}),e.jsx(l,{onClick:()=>p.mutate(a),disabled:p.isPending||!a.subject||!a.content,children:p.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Erstelle..."]}):"Newsletter erstellen"})]})]})]})]})]})]}),e.jsxs(w,{children:[e.jsxs(ee,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Pieces-Integration & Automatisches Teilen"]}),e.jsx(ae,{children:"Teile wichtige Newsletter-Inhalte automatisch über Pieces API für Teamkollaboration"})]}),e.jsx(k,{children:e.jsx(je,{})})]}),e.jsx(w,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"w-4 h-4 absolute left-3 top-3 text-gray-400"}),e.jsx(R,{placeholder:"Newsletter suchen...",value:r,onChange:s=>i(s.target.value),className:"pl-9"})]}),e.jsxs(L,{value:n,onValueChange:x,children:[e.jsx(U,{children:e.jsx(G,{placeholder:"Status"})}),e.jsxs(z,{children:[e.jsx(j,{value:"all",children:"Alle Status"}),e.jsx(j,{value:"draft",children:"Entwürfe"}),e.jsx(j,{value:"scheduled",children:"Geplant"}),e.jsx(j,{value:"sent",children:"Gesendet"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:u.map(s=>{var t,v;return e.jsx(w,{children:e.jsxs(k,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s.subject}),E(s.status)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-4 h-4"}),new Date(s.createdAt).toLocaleDateString("de-DE")]}),s.recipientCount&&s.recipientCount>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-4 h-4"}),s.recipientCount.toLocaleString()," Empfänger"]}),s.sentAt&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-4 h-4"}),"Gesendet: ",new Date(s.sentAt).toLocaleString("de-DE")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{type:"newsletter",itemId:s.id,title:s.subject,compact:!0}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>D(s.content),children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx(l,{size:"sm",variant:"outline",children:e.jsx(V,{className:"w-4 h-4"})})]})]}),e.jsxs(ie,{defaultValue:"preview",className:"w-full",children:[e.jsxs(ce,{className:"mx-4 mt-4",children:[e.jsx(N,{value:"preview",children:"Vorschau"}),e.jsx(N,{value:"content",children:"Volltext"}),e.jsx(N,{value:"articles",children:"Extrahierte Artikel"}),e.jsx(N,{value:"sources",children:"Quellen"}),e.jsx(N,{value:"analytics",children:"Analytics"})]}),e.jsx(b,{value:"preview",className:"p-4",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-6 rounded-lg",children:e.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[s.content.substring(0,300),"..."]})})}),e.jsx(b,{value:"content",className:"p-4",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-6 rounded-lg max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:s.content})})}),e.jsx(b,{value:"articles",className:"p-4",children:e.jsx("div",{className:"space-y-3",children:(t=s.extractedArticles)!=null&&t.length?s.extractedArticles.map((f,T)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(de,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:f.title}),e.jsx(C,{variant:"outline",children:f.type})]}),e.jsx(l,{size:"sm",variant:"outline",children:e.jsx(S,{className:"w-4 h-4"})})]},T)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Keine Artikel extrahiert"})})}),e.jsx(b,{value:"sources",className:"p-4",children:e.jsx("div",{className:"space-y-3",children:(v=s.sources)!=null&&v.length?s.sources.map((f,T)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oe,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:f.name})]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>window.open(f.url,"_blank"),children:e.jsx(S,{className:"w-4 h-4"})})]},T)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Keine Quellen definiert"})})}),e.jsx(b,{value:"analytics",className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Öffnungsrate"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.status==="sent"?"73.2%":"N/A"})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-900 dark:text-green-100",children:"Click Rate"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.status==="sent"?"12.8%":"N/A"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-purple-900 dark:text-purple-100",children:"Shares"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:s.status==="sent"?"34":"N/A"})]})]})})]})]})},s.id)})}),u.length===0&&e.jsx(w,{children:e.jsx(k,{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Keine Newsletter gefunden"}),e.jsx("p",{className:"text-gray-500 mb-4",children:r||n!=="all"?"Keine Newsletter entsprechen den aktuellen Filtern.":"Erstelle deinen ersten Newsletter."}),e.jsxs(l,{onClick:()=>d(!0),children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Newsletter erstellen"]})]})})})]})}export{ve as default};
