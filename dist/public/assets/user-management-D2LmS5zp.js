import{e as je,u as ge,U as pe,r as p,g as W,h as A,j as e,o as _,p as ve,B as x,q as J,s as G,t as X,O as Y,I as u,w as S,x as T,y as D,z as U,E as t,l as fe,m as Ne,n as L,H as I,C as E,a as k,b as F,P,c as q,a8 as O,J as R,A as be,Q as B,R as Z,S as ye}from"./index-Dm22qi9h.js";import{o as we,u as Ce,F as ee,a as l,b as c,c as d,d as o,e as m,t as Me,h as Ae,g as Se,i as Te,s as f}from"./types--AxGqAm3.js";import{S as se}from"./switch-CWNsPlWW.js";import{T as De,a as Ue,b as ae,c as h,d as Le,e as j}from"./table-CD4zTI82.js";import{S as Ie}from"./square-pen-BRq2if-8.js";import{T as Ee}from"./trash-2-2KpnWBrB.js";import{K as ke}from"./key-DDW1IMqW.js";import{C as Fe}from"./crown-_04pdp79.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=je("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),qe=r=>we({email:f().email(r("validation.invalidEmail")),firstName:f().min(1,r("validation.firstNameRequired")),lastName:f().min(1,r("validation.lastNameRequired")),role:Te(["admin","reviewer","user"]),isActive:Se(),permissions:Ae(f()).optional()}),Re=[{id:"1",email:"admin@helix.com",firstName:"Max",lastName:"Mustermann",role:"admin",isActive:!0,lastLoginAt:"2025-01-27T10:30:00Z",createdAt:"2024-12-01T09:00:00Z",permissions:["read","write","delete","admin","user_management"],profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=admin"},{id:"2",email:"reviewer@helix.com",firstName:"Anna",lastName:"Schmidt",role:"reviewer",isActive:!0,lastLoginAt:"2025-01-27T08:15:00Z",createdAt:"2024-12-15T14:30:00Z",permissions:["read","write","approve"],profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=reviewer"},{id:"3",email:"user@helix.com",firstName:"Thomas",lastName:"Weber",role:"user",isActive:!0,lastLoginAt:"2025-01-26T16:45:00Z",createdAt:"2025-01-10T11:20:00Z",permissions:["read"],profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=user"},{id:"4",email:"inactive@helix.com",firstName:"Maria",lastName:"Klein",role:"user",isActive:!1,createdAt:"2024-11-20T12:00:00Z",permissions:["read"]}],Be=[{id:"1",userId:"1",action:"User Login",details:"Successful login via SSO",timestamp:"2025-01-27T10:30:00Z",ipAddress:"192.168.1.100"},{id:"2",userId:"2",action:"Approval Action",details:"Approved newsletter 'Weekly MedTech Update'",timestamp:"2025-01-27T08:15:00Z",ipAddress:"192.168.1.101"},{id:"3",userId:"1",action:"User Created",details:"Created new user account for thomas.weber@helix.com",timestamp:"2025-01-26T14:20:00Z",ipAddress:"192.168.1.100"}],Ze={admin:"bg-red-100 text-red-800 border-red-200",reviewer:"bg-blue-100 text-blue-800 border-blue-200",user:"bg-green-100 text-green-800 border-green-200"},Oe={admin:Fe,reviewer:ye,user:O},ze=r=>[{id:"read",label:r("permissions.read"),description:r("permissions.readDesc")},{id:"write",label:r("permissions.write"),description:r("permissions.writeDesc")},{id:"delete",label:r("permissions.delete"),description:r("permissions.deleteDesc")},{id:"approve",label:r("permissions.approve"),description:r("permissions.approveDesc")},{id:"admin",label:r("permissions.admin"),description:r("permissions.adminDesc")},{id:"user_management",label:r("permissions.userManagement"),description:r("permissions.userManagementDesc")}];function Ye(){const{toast:r}=ge(),{t:a,language:re}=pe(),[z,K]=p.useState(null),[ie,N]=p.useState(!1),[ne,v]=p.useState(!1),[g,te]=p.useState(""),[b,le]=p.useState("all"),ce=qe(a),de=ze(a),i=Ce({resolver:Me(ce),defaultValues:{email:"",firstName:"",lastName:"",role:"user",isActive:!0,permissions:["read"]}}),{data:V=Re,isLoading:Ke}=W({queryKey:["/api/users"],enabled:!1}),{data:oe=Be,isLoading:Ve}=W({queryKey:["/api/users/activity"],enabled:!1}),y=A({mutationFn:async s=>await Z("/api/users","POST",s),onSuccess:()=>{B.invalidateQueries({queryKey:["/api/users"]}),N(!1),i.reset(),r({title:a("userManagement.userCreated"),description:a("userManagement.userCreatedDesc")})},onError:()=>{r({title:a("common.error"),description:a("userManagement.createError"),variant:"destructive"})}}),w=A({mutationFn:async({id:s,...n})=>await Z(`/api/users/${s}`,"PATCH",n),onSuccess:()=>{B.invalidateQueries({queryKey:["/api/users"]}),v(!1),K(null),i.reset(),r({title:a("userManagement.userUpdated"),description:a("userManagement.userUpdatedDesc")})},onError:()=>{r({title:a("common.error"),description:a("userManagement.updateError"),variant:"destructive"})}}),me=A({mutationFn:async s=>await Z(`/api/users/${s}`,"DELETE"),onSuccess:()=>{B.invalidateQueries({queryKey:["/api/users"]}),r({title:a("userManagement.userDeleted"),description:a("userManagement.userDeletedDesc")})},onError:()=>{r({title:a("common.error"),description:a("userManagement.deleteError"),variant:"destructive"})}}),xe=V.filter(s=>{var Q,$;const n=g===""||s.email.toLowerCase().includes(g.toLowerCase())||((Q=s.firstName)==null?void 0:Q.toLowerCase().includes(g.toLowerCase()))||(($=s.lastName)==null?void 0:$.toLowerCase().includes(g.toLowerCase())),M=b==="all"||s.role===b;return n&&M}),C=s=>{const n=re==="de"?"de-DE":"en-US";return new Date(s).toLocaleDateString(n,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},ue=s=>{K(s),i.reset({email:s.email,firstName:s.firstName||"",lastName:s.lastName||"",role:s.role,isActive:s.isActive,permissions:s.permissions}),v(!0)},H=s=>{z?w.mutate({...s,id:z.id}):y.mutate(s)},he=s=>{const n=Oe[s]||O;return e.jsx(n,{className:"h-4 w-4"})};return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:a("userManagement.title")}),e.jsx("p",{className:"text-muted-foreground",children:a("userManagement.subtitle")})]}),e.jsxs(_,{open:ie,onOpenChange:N,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(x,{children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),a("userManagement.newUser")]})}),e.jsxs(J,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsx(X,{children:a("userManagement.createUser")}),e.jsx(Y,{children:a("userManagement.createDescription")})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(H),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{control:i.control,name:"firstName",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:a("userManagement.firstName")}),e.jsx(o,{children:e.jsx(u,{...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:i.control,name:"lastName",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:a("userManagement.lastName")}),e.jsx(o,{children:e.jsx(u,{...s})}),e.jsx(m,{})]})})]}),e.jsx(l,{control:i.control,name:"email",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:a("userManagement.email")}),e.jsx(o,{children:e.jsx(u,{type:"email",...s})}),e.jsx(m,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{control:i.control,name:"role",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:a("userManagement.role")}),e.jsxs(S,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(T,{children:e.jsx(D,{})})}),e.jsxs(U,{children:[e.jsx(t,{value:"user",children:a("roles.user")}),e.jsx(t,{value:"reviewer",children:a("roles.reviewer")}),e.jsx(t,{value:"admin",children:a("roles.admin")})]})]}),e.jsx(m,{})]})}),e.jsx(l,{control:i.control,name:"isActive",render:({field:s})=>e.jsxs(c,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{className:"text-base",children:a("userManagement.activeSwitch")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a("userManagement.activeSwitchDesc")})]}),e.jsx(o,{children:e.jsx(se,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>N(!1),children:a("common.cancel")}),e.jsx(x,{type:"submit",disabled:y.isPending,children:y.isPending?a("button.creating"):a("button.create")})]})]})})]})]})]}),e.jsxs(fe,{defaultValue:"users",className:"space-y-6",children:[e.jsxs(Ne,{children:[e.jsx(L,{value:"users",children:a("userManagement.tabs.users")}),e.jsx(L,{value:"activity",children:a("userManagement.tabs.activity")}),e.jsx(L,{value:"permissions",children:a("userManagement.tabs.permissions")})]}),e.jsx(I,{value:"users",children:e.jsxs(E,{children:[e.jsxs(k,{children:[e.jsx(F,{children:a("userManagement.allUsers")}),e.jsx(P,{children:a("userManagement.allUsersDesc")}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(u,{placeholder:a("userManagement.searchUsers"),value:g,onChange:s=>te(s.target.value),className:"max-w-sm"}),e.jsxs(S,{value:b,onValueChange:le,children:[e.jsx(T,{className:"w-40",children:e.jsx(D,{})}),e.jsxs(U,{children:[e.jsx(t,{value:"all",children:a("userManagement.allRoles")}),e.jsx(t,{value:"admin",children:a("roles.admin")}),e.jsx(t,{value:"reviewer",children:a("roles.reviewer")}),e.jsx(t,{value:"user",children:a("roles.user")})]})]})]})]}),e.jsx(q,{children:e.jsxs(De,{children:[e.jsx(Ue,{children:e.jsxs(ae,{children:[e.jsx(h,{children:a("userManagement.userColumn")}),e.jsx(h,{children:a("userManagement.roleColumn")}),e.jsx(h,{children:a("userManagement.statusColumn")}),e.jsx(h,{children:a("userManagement.lastLoginColumn")}),e.jsx(h,{children:a("userManagement.createdColumn")}),e.jsx(h,{className:"text-right",children:a("userManagement.actionsColumn")})]})}),e.jsx(Le,{children:xe.map(s=>e.jsxs(ae,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:`${s.firstName} ${s.lastName}`,className:"w-8 h-8 rounded-full"}):e.jsx(O,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]})}),e.jsx(j,{children:e.jsxs(R,{className:Ze[s.role],variant:"outline",children:[he(s.role),e.jsx("span",{className:"ml-1 capitalize",children:s.role})]})}),e.jsx(j,{children:e.jsx(R,{variant:s.isActive?"default":"secondary",children:s.isActive?a("common.active"):a("common.inactive")})}),e.jsx(j,{children:s.lastLoginAt?C(s.lastLoginAt):a("userManagement.never")}),e.jsx(j,{children:C(s.createdAt)}),e.jsx(j,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>ue(s),children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>me.mutate(s.id),disabled:s.role==="admin",children:e.jsx(Ee,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}),e.jsx(I,{value:"activity",children:e.jsxs(E,{children:[e.jsxs(k,{children:[e.jsx(F,{children:a("userManagement.userActivities")}),e.jsx(P,{children:a("userManagement.userActivitiesDesc")})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:oe.map(s=>{const n=V.find(M=>M.id===s.userId);return e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:e.jsx(be,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.action}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.details}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:[a("userManagement.userLabel")," ",n==null?void 0:n.firstName," ",n==null?void 0:n.lastName]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:C(s.timestamp)}),s.ipAddress&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["IP: ",s.ipAddress]})]})]})]})]},s.id)})})})]})}),e.jsx(I,{value:"permissions",children:e.jsxs(E,{children:[e.jsxs(k,{children:[e.jsx(F,{children:a("userManagement.managePermissions")}),e.jsx(P,{children:a("userManagement.managePermissionsDesc")})]}),e.jsx(q,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:de.map(s=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium",children:s.label}),e.jsxs(R,{variant:"outline",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),s.id]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]},s.id))})})]})})]}),e.jsx(_,{open:ne,onOpenChange:v,children:e.jsxs(J,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsx(X,{children:"Benutzer bearbeiten"}),e.jsx(Y,{children:"Bearbeiten Sie die Benutzerdaten und Berechtigungen."})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(H),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{control:i.control,name:"firstName",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Vorname"}),e.jsx(o,{children:e.jsx(u,{...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:i.control,name:"lastName",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Nachname"}),e.jsx(o,{children:e.jsx(u,{...s})}),e.jsx(m,{})]})})]}),e.jsx(l,{control:i.control,name:"email",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"E-Mail"}),e.jsx(o,{children:e.jsx(u,{type:"email",...s})}),e.jsx(m,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{control:i.control,name:"role",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Rolle"}),e.jsxs(S,{onValueChange:s.onChange,value:s.value,children:[e.jsx(o,{children:e.jsx(T,{children:e.jsx(D,{})})}),e.jsxs(U,{children:[e.jsx(t,{value:"user",children:"Benutzer"}),e.jsx(t,{value:"reviewer",children:"Reviewer"}),e.jsx(t,{value:"admin",children:"Administrator"})]})]}),e.jsx(m,{})]})}),e.jsx(l,{control:i.control,name:"isActive",render:({field:s})=>e.jsxs(c,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{className:"text-base",children:"Aktiv"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Benutzer kann sich anmelden"})]}),e.jsx(o,{children:e.jsx(se,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>v(!1),children:a("common.cancel")}),e.jsx(x,{type:"submit",disabled:w.isPending,children:w.isPending?a("button.saving"):a("button.save")})]})]})})]})})]})}export{Ye as default};
