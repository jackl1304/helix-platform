import{r as g,g as Q,h as G,j as e,o as U,p as he,B as w,q,s as L,t as V,O,ad as D,v as m,J as P,C as p,c as b,k as H,T as ge,a7 as je,I as T,w as A,x as F,y as B,z,E as l,a as pe,b as be,a1 as fe,Q as K,ar as k,R as M,a5 as ve,a8 as Ne,W as ye,V as we,A as Se}from"./index-Dm22qi9h.js";import{S as ke}from"./separator-CPcIpOfY.js";import{S as R}from"./switch-CWNsPlWW.js";import{u as Ce,t as Ee,F as Te,a as f,b as v,c as N,d as y,e as C,f as W,o as De,g as $,n as J,s as _,i as X}from"./types--AxGqAm3.js";import{P as Y}from"./plus-gaIGr6ZR.js";import{D as Pe}from"./dollar-sign-NYdouDeN.js";import{C as Ae}from"./calendar-B2qkWIGY.js";import{E as Fe}from"./eye-KEHLO33x.js";import{S as Be}from"./square-pen-BRq2if-8.js";import{T as ee}from"./trash-2-2KpnWBrB.js";import{C as ze}from"./crown-_04pdp79.js";function $e(){const[a,S]=g.useState(""),[t,u]=g.useState("all"),[h,n]=g.useState("all"),[r,o]=g.useState(!1),[x,se]=g.useState(null),[ne,I]=g.useState(!1),[i,ae]=g.useState(null),[te,Z]=g.useState(!1),ie=s=>{se(s),I(!0)},re=s=>{ae(s),Z(!0)},le=async s=>{if(confirm("Sind Sie sicher, dass Sie diesen Tenant löschen möchten?"))try{await M(`/api/admin/tenants/${s}`,"DELETE"),K.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Tenant gelöscht",description:"Der Tenant wurde erfolgreich gelöscht."})}catch{k({title:"Fehler",description:"Fehler beim Löschen des Tenants.",variant:"destructive"})}},{data:ce=[],isLoading:de}=Q({queryKey:["/api/admin/tenants"]}),{data:E}=Q({queryKey:["/api/admin/stats"],queryFn:async()=>({totalTenants:3,activeTenants:2,trialTenants:1,totalRevenue:3398,avgRevenuePerTenant:1132.67,planDistribution:{starter:1,professional:1,enterprise:1},growthRate:15.4,churnRate:2.1})});G({mutationFn:async s=>{var j;const d={name:s.companyName,slug:((j=s.companyName)==null?void 0:j.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""))||"",industry:s.industry||"Medical Technology",subscriptionPlan:s.subscriptionPlan||"professional",subscriptionStatus:"trial",billingEmail:s.contactEmail,contactName:s.contactName,contactEmail:s.contactEmail,maxUsers:s.subscriptionPlan==="starter"?5:s.subscriptionPlan==="professional"?25:999999,maxDataSources:10,apiAccessEnabled:s.subscriptionPlan!=="starter"};return await M("/api/admin/tenants","POST",d)},onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/tenants"]}),o(!1),k({title:"Tenant erstellt",description:"Der neue Tenant wurde erfolgreich erstellt."})}});const c=ce.filter(s=>{const d=s.name.toLowerCase().includes(a.toLowerCase())||(s.contactEmail||s.billingEmail).toLowerCase().includes(a.toLowerCase()),j=t==="all"||s.subscriptionStatus===t,ue=h==="all"||s.subscriptionPlan===h;return d&&j&&ue}),oe=({status:s})=>{const d={active:"bg-green-100 text-green-800",trial:"bg-blue-100 text-blue-800",suspended:"bg-red-100 text-red-800",canceled:"bg-gray-100 text-gray-800"},j={active:e.jsx(H,{className:"w-3 h-3 mr-1"}),trial:e.jsx(we,{className:"w-3 h-3 mr-1"}),suspended:e.jsx(ye,{className:"w-3 h-3 mr-1"}),canceled:e.jsx(ee,{className:"w-3 h-3 mr-1"})};return e.jsxs(P,{className:d[s],children:[j[s],s.charAt(0).toUpperCase()+s.slice(1)]})},xe=({plan:s})=>{const d={starter:"bg-blue-100 text-blue-800",professional:"bg-purple-100 text-purple-800",enterprise:"bg-orange-100 text-orange-800"},j={starter:e.jsx(D,{className:"w-3 h-3 mr-1"}),professional:e.jsx(ze,{className:"w-3 h-3 mr-1"}),enterprise:e.jsx(Se,{className:"w-3 h-3 mr-1"})};return e.jsxs(P,{className:d[s],children:[j[s],s.charAt(0).toUpperCase()+s.slice(1)]})},me=({customer:s})=>e.jsx(p,{className:"mb-4 hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 via-purple-600 to-cyan-700 rounded-xl text-white font-bold text-lg",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{status:s.subscriptionStatus}),e.jsx(xe,{plan:s.subscriptionPlan})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),s.billingEmail||s.contactEmail||"Keine E-Mail"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),s.maxUsers||0," Max. Benutzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),"Erstellt: ",new Date(s.createdAt).toLocaleDateString("de-DE")]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[s.subscriptionPlan==="enterprise"?"€2,499":s.subscriptionPlan==="professional"?"€899":"€199",e.jsx("span",{className:"text-sm text-muted-foreground",children:"/Monat"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:[s.maxDataSources," Datenquellen / ",s.maxUsers," Max. Benutzer"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>re(s),title:"Tenant anzeigen",children:e.jsx(Fe,{className:"w-4 h-4"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>ie(s),title:"Tenant bearbeiten",children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>le(s.id),title:"Tenant löschen",children:e.jsx(ee,{className:"w-4 h-4"})})]})]})]}),e.jsx(ke,{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.maxUsers}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Max. Benutzer"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.maxDataSources}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Datenquellen"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.apiAccessEnabled?"Ja":"Nein"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"API-Zugang"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.subscriptionStatus==="trial"?"Test":"Aktiv"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Status"})]})]})]})});return e.jsxs("div",{className:"container mx-auto p-6 space-y-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Kunden-Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Verwalten Sie Ihre SaaS-Kunden und deren Subscriptions"})]}),e.jsxs(U,{open:r,onOpenChange:o,children:[e.jsx(he,{asChild:!0,children:e.jsxs(w,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Neuen Kunden hinzufügen"]})}),e.jsxs(q,{className:"max-w-2xl",children:[e.jsxs(L,{children:[e.jsx(V,{children:"Neuen Tenant erstellen"}),e.jsx(O,{children:"Erstellen Sie einen neuen Kunden-Tenant mit Subscription"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"w-16 h-16 mx-auto mb-4 text-blue-500"}),e.jsx("p",{className:"text-muted-foreground",children:"Tenant-Erstellung über das vollständige Onboarding-System"}),e.jsx(w,{className:"mt-4",onClick:()=>window.open("/tenant-onboarding","_blank"),children:"Onboarding-Prozess starten"})]})]})]}),e.jsx(U,{open:te,onOpenChange:Z,children:e.jsxs(q,{className:"max-w-4xl",children:[e.jsxs(L,{children:[e.jsxs(V,{children:["Tenant Details - ",i==null?void 0:i.name]}),e.jsx(O,{children:"Vollständige Informationen zum Tenant"})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Firma"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.name})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Slug"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.slug})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"E-Mail"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.billingEmail})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Subscription Plan"}),e.jsx(P,{variant:i.subscriptionPlan==="enterprise"?"destructive":"default",children:i.subscriptionPlan})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Status"}),e.jsx(P,{variant:i.subscriptionStatus==="active"?"default":"secondary",children:i.subscriptionStatus})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Max. Benutzer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.maxUsers})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Max. Datenquellen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.maxDataSources})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"API-Zugang"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.apiAccessEnabled?"Aktiviert":"Deaktiviert"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Erstellt am"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(i.createdAt).toLocaleDateString("de-DE")})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Trial endet am"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.trialEndsAt?new Date(i.trialEndsAt).toLocaleDateString("de-DE"):"Kein Trial"})]})]})]})]})}),e.jsx(U,{open:ne,onOpenChange:I,children:e.jsxs(q,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(L,{children:[e.jsxs(V,{children:["Tenant bearbeiten - ",x==null?void 0:x.name]}),e.jsx(O,{children:"Tenant-Einstellungen ändern"})]}),x&&e.jsx(Me,{tenant:x,onClose:()=>I(!1)})]})})]}),E&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(p,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Gesamt Tenants"}),e.jsx("div",{className:"text-2xl font-bold",children:E.totalTenants})]}),e.jsx(D,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(p,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Aktive Kunden"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:E.activeTenants})]}),e.jsx(H,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(p,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Monatsumsatz"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["€",E.totalRevenue.toLocaleString()]})]}),e.jsx(Pe,{className:"h-8 w-8 text-purple-500"})]})})}),e.jsx(p,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Wachstumsrate"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["+",E.growthRate,"%"]})]}),e.jsx(ge,{className:"h-8 w-8 text-orange-500"})]})})})]}),e.jsx(p,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Suche nach Firmenname oder E-Mail...",value:a,onChange:s=>S(s.target.value),className:"pl-10"})]})}),e.jsxs(A,{value:t,onValueChange:u,children:[e.jsx(F,{className:"w-40",children:e.jsx(B,{})}),e.jsxs(z,{children:[e.jsx(l,{value:"all",children:"Alle Status"}),e.jsx(l,{value:"active",children:"Aktiv"}),e.jsx(l,{value:"trial",children:"Trial"}),e.jsx(l,{value:"suspended",children:"Gesperrt"}),e.jsx(l,{value:"canceled",children:"Gekündigt"})]})]}),e.jsxs(A,{value:h,onValueChange:n,children:[e.jsx(F,{className:"w-40",children:e.jsx(B,{})}),e.jsxs(z,{children:[e.jsx(l,{value:"all",children:"Alle Pläne"}),e.jsx(l,{value:"starter",children:"Starter"}),e.jsx(l,{value:"professional",children:"Professional"}),e.jsx(l,{value:"enterprise",children:"Enterprise"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:de?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Lade Kunden..."})]}):(c==null?void 0:c.length)===0?e.jsx(p,{children:e.jsxs(b,{className:"p-12 text-center",children:[e.jsx(D,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Kunden gefunden"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:a||t!=="all"||h!=="all"?"Ihre Suchkriterien ergaben keine Treffer.":"Sie haben noch keine Kunden hinzugefügt."}),!a&&t==="all"&&h==="all"&&e.jsxs(w,{onClick:()=>o(!0),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Ersten Kunden hinzufügen"]})]})}):c==null?void 0:c.map(s=>e.jsx(me,{customer:s},s.id))}),c&&c.length>0&&e.jsxs(p,{children:[e.jsx(pe,{children:e.jsxs(be,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5"}),"Zusammenfassung (",c.length," Kunden)"]})}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["€",c.length*1200]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gesamt-Umsatz/Monat"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.reduce((s,d)=>s+d.maxUsers,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gesamt-Benutzer"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.reduce((s,d)=>s+d.maxDataSources,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Datenquellen"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.filter(s=>s.subscriptionStatus==="active").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"})]})]})})]})]})}const Ke=De({name:_().min(1,"Name ist erforderlich"),subscriptionPlan:X(["starter","professional","enterprise"]),subscriptionStatus:X(["trial","active","cancelled","suspended"]),billingEmail:_().email("Gültige E-Mail erforderlich"),maxUsers:J().min(1),maxDataSources:J().min(1),apiAccessEnabled:$(),customBrandingEnabled:$()});function Me({tenant:a,onClose:S}){const t=Ce({resolver:Ee(Ke),defaultValues:{name:a.name,subscriptionPlan:a.subscriptionPlan,subscriptionStatus:a.subscriptionStatus,billingEmail:a.billingEmail,maxUsers:a.maxUsers,maxDataSources:a.maxDataSources,apiAccessEnabled:a.apiAccessEnabled,customBrandingEnabled:a.customBrandingEnabled||!1}}),u=G({mutationFn:async n=>await M(`/api/admin/tenants/${a.id}`,"PUT",n),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Tenant aktualisiert",description:"Die Tenant-Einstellungen wurden erfolgreich gespeichert."}),S()},onError:n=>{k({title:"Fehler",description:n.message||"Fehler beim Speichern der Änderungen.",variant:"destructive"})}}),h=n=>{u.mutate(n)};return e.jsx(Te,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(h),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:t.control,name:"name",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Firmenname"}),e.jsx(y,{children:e.jsx(T,{...n})}),e.jsx(C,{})]})}),e.jsx(f,{control:t.control,name:"billingEmail",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Billing E-Mail"}),e.jsx(y,{children:e.jsx(T,{...n,type:"email"})}),e.jsx(C,{})]})}),e.jsx(f,{control:t.control,name:"subscriptionPlan",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Subscription Plan"}),e.jsxs(A,{onValueChange:n.onChange,defaultValue:n.value,children:[e.jsx(y,{children:e.jsx(F,{children:e.jsx(B,{})})}),e.jsxs(z,{children:[e.jsx(l,{value:"starter",children:"Starter"}),e.jsx(l,{value:"professional",children:"Professional"}),e.jsx(l,{value:"enterprise",children:"Enterprise"})]})]}),e.jsx(C,{})]})}),e.jsx(f,{control:t.control,name:"subscriptionStatus",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Status"}),e.jsxs(A,{onValueChange:n.onChange,defaultValue:n.value,children:[e.jsx(y,{children:e.jsx(F,{children:e.jsx(B,{})})}),e.jsxs(z,{children:[e.jsx(l,{value:"trial",children:"Trial"}),e.jsx(l,{value:"active",children:"Aktiv"}),e.jsx(l,{value:"cancelled",children:"Gekündigt"}),e.jsx(l,{value:"suspended",children:"Gesperrt"})]})]}),e.jsx(C,{})]})}),e.jsx(f,{control:t.control,name:"maxUsers",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Max. Benutzer"}),e.jsx(y,{children:e.jsx(T,{...n,type:"number",onChange:r=>n.onChange(parseInt(r.target.value))})}),e.jsx(C,{})]})}),e.jsx(f,{control:t.control,name:"maxDataSources",render:({field:n})=>e.jsxs(v,{children:[e.jsx(N,{children:"Max. Datenquellen"}),e.jsx(y,{children:e.jsx(T,{...n,type:"number",onChange:r=>n.onChange(parseInt(r.target.value))})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx(f,{control:t.control,name:"apiAccessEnabled",render:({field:n})=>e.jsxs(v,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(N,{children:"API-Zugang"}),e.jsx(W,{children:"Erlaubt Zugang zu API-Endpunkten"})]}),e.jsx(y,{children:e.jsx(R,{checked:n.value,onCheckedChange:n.onChange})})]})}),e.jsx(f,{control:t.control,name:"customBrandingEnabled",render:({field:n})=>e.jsxs(v,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(N,{children:"Custom Branding"}),e.jsx(W,{children:"Erlaubt eigenes Branding"})]}),e.jsx(y,{children:e.jsx(R,{checked:n.value,onCheckedChange:n.onChange})})]})})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Kundenberechtigung verwalten"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bestimmen Sie, welche Bereiche der Kunde in seinem Dashboard sehen und verwenden darf"}),e.jsx("div",{className:"max-h-80 overflow-y-auto border rounded-lg p-4 bg-gray-50 dark:bg-gray-900",children:e.jsx(Ie,{tenant:a})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:S,children:"Abbrechen"}),e.jsx(w,{type:"submit",disabled:u.isPending,children:u.isPending?"Speichere...":"Speichern"})]})]})})}function Ie({tenant:a}){const[S,t]=g.useState(()=>a.customerPermissions||{dashboard:!0,regulatoryUpdates:!0,legalCases:!0,knowledgeBase:!0,newsletters:!0,analytics:!1,reports:!1,dataCollection:!1,globalSources:!1,historicalData:!1,administration:!1,userManagement:!1,systemSettings:!1,auditLogs:!1,aiInsights:!1,advancedAnalytics:!1}),u=G({mutationFn:async r=>await M(`/api/admin/tenants/${a.id}/permissions`,"PUT",{customerPermissions:r}),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Berechtigungen aktualisiert",description:"Die Kundenberechtigung wurden erfolgreich gespeichert."})},onError:r=>{k({title:"Fehler",description:r.message||"Fehler beim Speichern der Berechtigungen.",variant:"destructive"})}}),h=(r,o)=>{const x={...S,[r]:o};t(x),u.mutate(x)},n=[{title:"Basis-Zugriff",description:"Grundlegende Bereiche für alle Kunden",permissions:[{key:"dashboard",label:"Dashboard",description:"Hauptübersicht und Statistiken"},{key:"regulatoryUpdates",label:"Regulatory Updates",description:"Regulatorische Änderungen und Updates"},{key:"legalCases",label:"Rechtsprechung",description:"Gerichtsentscheidungen und Präzedenzfälle"},{key:"knowledgeBase",label:"Wissensdatenbank",description:"Artikel und Dokumentation"},{key:"newsletters",label:"Newsletter",description:"Newsletter-Verwaltung und -Abonnements"}]},{title:"Erweiterte Features",description:"Zusätzliche Funktionen je nach Subscription",permissions:[{key:"analytics",label:"Analytics",description:"Datenanalyse und Berichte"},{key:"reports",label:"Reports",description:"Detaillierte Berichte generieren"},{key:"aiInsights",label:"KI-Insights",description:"KI-gestützte Analysen und Erkenntnisse"},{key:"advancedAnalytics",label:"Erweiterte Analytics",description:"Fortgeschrittene Analysefunktionen"}]},{title:"Daten-Management",description:"Datenquellen und -verwaltung",permissions:[{key:"globalSources",label:"Globale Quellen",description:"Zugang zu allen Datenquellen"},{key:"dataCollection",label:"Datensammlung",description:"Eigene Daten sammeln und verwalten"},{key:"historicalData",label:"Historische Daten",description:"Zugang zu historischen Datensätzen"}]},{title:"Administrative Bereiche",description:"Nur für besondere Fälle freigeben",permissions:[{key:"systemSettings",label:"Systemeinstellungen",description:"Zugang zu Systemkonfiguration"},{key:"userManagement",label:"Benutzerverwaltung",description:"Benutzer innerhalb des Tenants verwalten"},{key:"administration",label:"Administration",description:"Administrative Funktionen"},{key:"auditLogs",label:"Audit Logs",description:"Zugang zu System-Audit-Protokollen"}]}];return e.jsxs("div",{className:"space-y-4",children:[n.map(r=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"pb-2 border-b",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:r.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.description})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2",children:r.permissions.map(o=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-2 hover:bg-white dark:hover:bg-gray-800 bg-gray-50 dark:bg-gray-900 transition-colors",children:[e.jsxs("div",{className:"space-y-0 flex-1 pr-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:o.label}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:o.description})]}),e.jsx(R,{checked:S[o.key],onCheckedChange:x=>h(o.key,x),disabled:u.isPending,className:"flex-shrink-0",size:"sm"})]},o.key))})]},r.title)),u.isPending&&e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2",children:"💾 Speichere Änderungen..."})]})}export{$e as default};
