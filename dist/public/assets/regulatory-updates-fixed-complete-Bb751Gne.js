import{U as Z,r as d,g as T,X as ee,Y as se,j as e,W as f,B as h,_ as N,$ as o,C as n,c as i,a0 as b,k as L,G as P,a as w,b as F,I as v,w as S,x as U,y as k,z as C,E as m,D as ae,N as re,A as te,J as E,M as le,V as ne,T as ie}from"./index-Dm22qi9h.js";import{S as ce}from"./separator-CPcIpOfY.js";import{D as de}from"./download-CQfvf7I6.js";import{F as oe}from"./filter-CBkaAuG_.js";import{C as me}from"./calendar-B2qkWIGY.js";const xe=async()=>{const t=await fetch("http://localhost:3000/api/regulatory-updates");if(!t.ok)throw new Error("Failed to fetch regulatory updates");const a=await t.json();return(Array.isArray(a)?a:(a==null?void 0:a.data)??[]).map(r=>({id:String(r.id??r.uuid??crypto.randomUUID()),title:r.title??r.name??r.description??"Ohne Titel",summary:r.summary??r.description??r.content??"",authority:String(r.source_id??r.authority??r.source??"Unknown"),region:String(r.region??r.country??"Global"),published_at:r.published_at??r.created_at??new Date().toISOString(),priority:typeof r.priority=="string"?r.priority:"medium",category:typeof r.category=="string"?r.category:typeof r.type=="string"?r.type:"general",url:r.source_url??r.url,type:typeof r.type=="string"?r.type:void 0,status:typeof r.status=="string"?r.status:void 0}))},he=async()=>{const t=await fetch("http://localhost:3000/api/dashboard/stats");if(!t.ok)throw new Error("Failed to fetch dashboard stats");const a=await t.json();return{totalUpdates:(a==null?void 0:a.totalUpdates)??0,recentUpdates:(a==null?void 0:a.recentUpdates)??0,highPriority:(a==null?void 0:a.highPriority)??0,regions:(a==null?void 0:a.regions)??0,totalSources:(a==null?void 0:a.totalSources)??0,activeSources:(a==null?void 0:a.activeSources)??0,lastSync:(a==null?void 0:a.lastSync)??new Date().toISOString()}};function fe(){const{t}=Z(),[a,D]=d.useState(""),[r,R]=d.useState("all"),[u,_]=d.useState("all"),[g,B]=d.useState("all"),[j,I]=d.useState(""),[p,q]=d.useState(""),{data:z=[],isLoading:M,error:V,refetch:A}=T({queryKey:["regulatory-updates"],queryFn:xe,staleTime:5*60*1e3,refetchOnWindowFocus:!1}),{data:l,isLoading:O}=T({queryKey:["dashboard-stats"],queryFn:he,staleTime:2*60*1e3,refetchOnWindowFocus:!1}),x=ee(z),y=se(x,s=>{const c=!a||s.title.toLowerCase().includes(a.toLowerCase())||s.summary.toLowerCase().includes(a.toLowerCase())||s.authority.toLowerCase().includes(a.toLowerCase()),$=r==="all"||s.region===r,J=u==="all"||s.priority===u,X=g==="all"||s.type===g,Y=!j||!p||s.published_at>=j&&s.published_at<=p;return c&&$&&J&&X&&Y}),Q=Array.from(new Set(x.map(s=>s.region).filter(Boolean))),G=Array.from(new Set(x.map(s=>s.priority).filter(Boolean))),H=Array.from(new Set(x.map(s=>s.type).filter(Boolean))),K=s=>{switch(s){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},W=s=>{switch(s){case"urgent":return e.jsx(f,{className:"w-4 h-4"});case"high":return e.jsx(ie,{className:"w-4 h-4"});case"medium":return e.jsx(ne,{className:"w-4 h-4"});case"low":return e.jsx(L,{className:"w-4 h-4"});default:return e.jsx(b,{className:"w-4 h-4"})}};return V?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(f,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Fehler beim Laden der Daten"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Die regulatorischen Updates konnten nicht geladen werden."}),e.jsxs(h,{onClick:()=>A(),variant:"outline",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Erneut versuchen"]})]})}):e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("regulatoryUpdates.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:t("regulatoryUpdates.description")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(h,{onClick:()=>A(),variant:"outline",size:"sm",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),t("common.refresh")]}),e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),t("common.export")]})]})]}),e.jsx(ce,{}),O?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:o([...Array(4)],(s,c)=>e.jsx(n,{className:"animate-pulse",children:e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},c))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("regulatoryUpdates.totalUpdates")}),e.jsx("p",{className:"text-2xl font-bold",children:(l==null?void 0:l.totalUpdates)||0})]}),e.jsx(b,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("regulatoryUpdates.filtered")}),e.jsx("p",{className:"text-2xl font-bold",children:y.length})]}),e.jsx(L,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("regulatoryUpdates.highPriority")}),e.jsx("p",{className:"text-2xl font-bold",children:(l==null?void 0:l.highPriority)||0})]}),e.jsx(f,{className:"w-8 h-8 text-orange-500"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("regulatoryUpdates.regions")}),e.jsx("p",{className:"text-2xl font-bold",children:(l==null?void 0:l.regions)||0})]}),e.jsx(P,{className:"w-8 h-8 text-purple-500"})]})})})]}),e.jsxs(n,{children:[e.jsx(w,{children:e.jsxs(F,{className:"flex items-center",children:[e.jsx(oe,{className:"w-5 h-5 mr-2"}),t("regulatoryUpdates.filterSearch")]})}),e.jsx(i,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.searchPlaceholder")}),e.jsx(v,{placeholder:t("regulatoryUpdates.searchPlaceholder"),value:a,onChange:s=>D(s.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.region")}),e.jsxs(S,{value:r,onValueChange:R,children:[e.jsx(U,{children:e.jsx(k,{placeholder:t("regulatoryUpdates.allRegions")})}),e.jsxs(C,{children:[e.jsx(m,{value:"all",children:t("regulatoryUpdates.allRegions")}),o(Q,s=>e.jsx(m,{value:String(s),children:String(s)},String(s)))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.priority")}),e.jsxs(S,{value:u,onValueChange:_,children:[e.jsx(U,{children:e.jsx(k,{placeholder:t("regulatoryUpdates.allPriorities")})}),e.jsxs(C,{children:[e.jsx(m,{value:"all",children:t("regulatoryUpdates.allPriorities")}),o(G,s=>e.jsx(m,{value:String(s),children:String(s)},String(s)))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.type")}),e.jsxs(S,{value:g,onValueChange:B,children:[e.jsx(U,{children:e.jsx(k,{placeholder:t("regulatoryUpdates.allTypes")})}),e.jsxs(C,{children:[e.jsx(m,{value:"all",children:t("regulatoryUpdates.allTypes")}),o(H,s=>e.jsx(m,{value:String(s),children:String(s)},String(s)))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.startDate")}),e.jsx(v,{type:"date",value:j,onChange:s=>I(s.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:t("regulatoryUpdates.endDate")}),e.jsx(v,{type:"date",value:p,onChange:s=>q(s.target.value),className:"w-full"})]})]})})]}),M?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o([...Array(6)],(s,c)=>e.jsxs(n,{className:"animate-pulse",children:[e.jsxs(w,{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},`skeleton-${c}`))}):y.length===0?e.jsx(n,{children:e.jsxs(i,{className:"p-12 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t("regulatoryUpdates.noUpdates")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t("regulatoryUpdates.noUpdatesDescription")})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o(y,(s,c)=>e.jsxs(n,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(w,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(E,{variant:"outline",className:"text-xs",children:String(s.authority??"")}),e.jsx(E,{variant:"secondary",className:`text-xs text-white ${K(s.priority)}`,children:e.jsxs("span",{className:"flex items-center",children:[W(s.priority),e.jsx("span",{className:"ml-1",children:String(s.priority)})]})})]}),e.jsx(F,{className:"text-lg line-clamp-2",children:String(s.title??"")})]})})}),e.jsxs(i,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-3",children:String(s.summary??"")}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),String(s.region??"")]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),new Date(s.published_at).toLocaleDateString()]})]}),s.url&&e.jsx(h,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(le,{className:"w-3 h-3"})})})]})]})]},String(s.id??c)))}),e.jsx(n,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ae,{className:"w-6 h-6 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"Echte Daten aus 400+ regulatorischen Quellen"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Alle Daten werden in Echtzeit aus offiziellen regulatorischen Quellen wie FDA, EMA, BfArM, Health Canada, TGA, PMDA, MHRA, ANVISA, HSA und vielen weiteren Beh√∂rden weltweit geladen. Keine Mock-Daten oder Demo-Inhalte."}),e.jsxs("div",{className:"mt-3 flex items-center space-x-4 text-xs text-blue-600 dark:text-blue-400",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),(l==null?void 0:l.totalSources)||0," konfigurierte Quellen"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{className:"w-3 h-3 mr-1"}),(l==null?void 0:l.activeSources)||0," aktive Quellen"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(N,{className:"w-3 h-3 mr-1"}),"Letzte Aktualisierung: ",l!=null&&l.lastSync?new Date(l.lastSync).toLocaleString():"Unbekannt"]})]})]})]})})})]})}export{fe as default};
