{"version":3,"file":"regionalExpansionService.js","sourceRoot":"","sources":["../../server/services/regionalExpansionService.ts"],"names":[],"mappings":"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","sourcesContent":["import { storage } from '../storage';\r\n\r\ninterface RegionalAuthority {\r\n  id: string;\r\n  name: string;\r\n  country: string;\r\n  region: string;\r\n  apiUrl?: string;\r\n  rssFeeds: string[];\r\n  active: boolean;\r\n  dataTypes: string[];\r\n  priority: 'high' | 'medium' | 'low';\r\n}\r\n\r\ninterface RegionalUpdate {\r\n  authorityId: string;\r\n  title: string;\r\n  content: string;\r\n  type: string;\r\n  publishedAt: Date;\r\n  originalUrl?: string;\r\n  language: string;\r\n  translatedContent?: string;\r\n}\r\n\r\nexport class RegionalExpansionService {\r\n  private regionalAuthorities: RegionalAuthority[] = [\r\n    // Asian Authorities\r\n    {\r\n      id: 'mfds-korea',\r\n      name: 'Ministry of Food and Drug Safety',\r\n      country: 'South Korea',\r\n      region: 'Asia',\r\n      apiUrl: 'https://www.mfds.go.kr/api',\r\n      rssFeeds: ['https://www.mfds.go.kr/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Device Approvals', 'Safety Alerts', 'Regulations'],\r\n      priority: 'high'\r\n    },\r\n    {\r\n      id: 'thailand-fda',\r\n      name: 'Food and Drug Administration Thailand',\r\n      country: 'Thailand',\r\n      region: 'Asia',\r\n      rssFeeds: ['https://www.fda.moph.go.th/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Medical Device Registration', 'Recalls', 'Guidelines'],\r\n      priority: 'medium'\r\n    },\r\n    {\r\n      id: 'pmda-japan',\r\n      name: 'Pharmaceuticals and Medical Devices Agency',\r\n      country: 'Japan',\r\n      region: 'Asia',\r\n      apiUrl: 'https://www.pmda.go.jp/api',\r\n      rssFeeds: ['https://www.pmda.go.jp/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Shonin Approvals', 'Safety Information', 'Guidelines'],\r\n      priority: 'high'\r\n    },\r\n    // European Authorities\r\n    {\r\n      id: 'aifa-italy',\r\n      name: 'Italian Medicines Agency',\r\n      country: 'Italy',\r\n      region: 'Europe',\r\n      rssFeeds: ['https://www.aifa.gov.it/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['CE Mark Updates', 'Safety Communications', 'Guidelines'],\r\n      priority: 'medium'\r\n    },\r\n    {\r\n      id: 'aemps-spain',\r\n      name: 'Spanish Agency of Medicines and Medical Devices',\r\n      country: 'Spain',\r\n      region: 'Europe',\r\n      rssFeeds: ['https://www.aemps.gob.es/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Device Registrations', 'Safety Alerts', 'Regulatory Updates'],\r\n      priority: 'medium'\r\n    },\r\n    // Middle Eastern Authorities\r\n    {\r\n      id: 'saudi-fda',\r\n      name: 'Saudi Food and Drug Authority',\r\n      country: 'Saudi Arabia',\r\n      region: 'Middle East',\r\n      apiUrl: 'https://www.sfda.gov.sa/api',\r\n      rssFeeds: ['https://www.sfda.gov.sa/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['MDMA Registrations', 'Market Surveillance', 'Guidelines'],\r\n      priority: 'high'\r\n    },\r\n    {\r\n      id: 'uae-moh',\r\n      name: 'UAE Ministry of Health',\r\n      country: 'United Arab Emirates',\r\n      region: 'Middle East',\r\n      rssFeeds: ['https://www.mohap.gov.ae/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Device Approvals', 'Health Alerts', 'Regulations'],\r\n      priority: 'medium'\r\n    },\r\n    // African Authorities\r\n    {\r\n      id: 'sahpra',\r\n      name: 'South African Health Products Regulatory Authority',\r\n      country: 'South Africa',\r\n      region: 'Africa',\r\n      apiUrl: 'https://www.sahpra.org.za/api',\r\n      rssFeeds: ['https://www.sahpra.org.za/rss/news.xml'],\r\n      active: true,\r\n      dataTypes: ['Medical Device Registrations', 'Safety Alerts', 'Guidelines'],\r\n      priority: 'high'\r\n    }\r\n  ];\r\n\r\n  private async makeRequest(url: string): Promise<any> {\r\n    try {\r\n      console.log(`[Regional] Requesting: ${url}`);\r\n      \r\n      const response = await fetch(url, {\r\n        headers: {\r\n          'User-Agent': 'Helix-Regional-Monitor/1.0',\r\n          'Accept': 'application/json, application/xml, text/xml'\r\n        }\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`Regional API error: ${response.status} ${response.statusText}`);\r\n      }\r\n      \r\n      const contentType = response.headers.get('content-type');\r\n      if (contentType?.includes('application/json')) {\r\n        return await response.json();\r\n      } else {\r\n        return await response.text();\r\n      }\r\n    } catch (error) {\r\n      console.error(`[Regional] Request failed for ${url}:`, error);\r\n      // Return empty array until real API is available\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // ALLE MOCK-DATEN ENTFERNT - Nur echte APIs verwenden\r\n  private getMockRegionalData(url: string): RegionalUpdate[] {\r\n    console.log(`[Regional] MOCK DATA DELETED - No artificial data for ${url}`);\r\n    return [];\r\n  }\r\n\r\n  async collectRegionalUpdates(authorityId: string): Promise<void> {\r\n    try {\r\n      const authority = this.regionalAuthorities.find(auth => auth.id === authorityId);\r\n      if (!authority) {\r\n        throw new Error(`Unknown authority: ${authorityId}`);\r\n      }\r\n\r\n      console.log(`[Regional] Collecting updates from ${authority.name}`);\r\n\r\n      let updates: RegionalUpdate[] = [];\r\n\r\n      // Try API first if available\r\n      if (authority.apiUrl) {\r\n        try {\r\n          const apiData = await this.makeRequest(`${authority.apiUrl}/updates`);\r\n          updates = Array.isArray(apiData) ? apiData : [apiData];\r\n        } catch (error) {\r\n          console.log(`[Regional] API failed for ${authority.name} - NO MOCK DATA FALLBACK`);\r\n          updates = [];\r\n        }\r\n      } else {\r\n        // ALLE MOCK-DATEN ENTFERNT - Nur echte APIs verwenden\r\n        console.log(`[Regional] No API available for ${authority.name} - skipping (no mock data)`);\r\n        updates = [];\r\n      }\r\n\r\n      console.log(`[Regional] Found ${updates.length} updates from ${authority.name}`);\r\n\r\n      for (const update of updates) {\r\n        await this.processRegionalUpdate(update, authority);\r\n      }\r\n\r\n      console.log(`[Regional] Completed processing updates from ${authority.name}`);\r\n    } catch (error) {\r\n      console.error(`[Regional] Error collecting updates from ${authorityId}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async processRegionalUpdate(update: RegionalUpdate, authority: RegionalAuthority): Promise<void> {\r\n    try {\r\n      const regulatoryUpdate = {\r\n        id: `regional-${authority.id}-${Math.random().toString(36).substr(2, 9)}`,\r\n        title: `${authority.name}: ${update.title}`,\r\n        content: this.formatRegionalContent(update, authority),\r\n        source: `${authority.name} (Regional)`,\r\n        type: update.type,\r\n        region: authority.country,\r\n        authority: authority.name,\r\n        priority: this.determineRegionalPriority(update, authority),\r\n        published_at: update.publishedAt,\r\n        status: 'published',\r\n        metadata: {\r\n          authorityId: authority.id,\r\n          country: authority.country,\r\n          regionalArea: authority.region,\r\n          originalLanguage: update.language,\r\n          translatedContent: update.translatedContent,\r\n          originalUrl: update.originalUrl,\r\n          dataTypes: authority.dataTypes\r\n        }\r\n      };\r\n\r\n      await storage.createRegulatoryUpdate(regulatoryUpdate);\r\n      console.log(`[Regional] Successfully created update: ${update.title}`);\r\n    } catch (error) {\r\n      console.error('[Regional] Error processing regional update:', error);\r\n    }\r\n  }\r\n\r\n  private formatRegionalContent(update: RegionalUpdate, authority: RegionalAuthority): string {\r\n    const parts = [];\r\n\r\n    parts.push(`**Authority:** ${authority.name}`);\r\n    parts.push(`**Country:** ${authority.country}`);\r\n    parts.push(`**Region:** ${authority.region}`);\r\n    parts.push(`**Type:** ${update.type}`);\r\n\r\n    if (update.language !== 'en') {\r\n      parts.push(`**Original Language:** ${update.language}`);\r\n    }\r\n\r\n    if (update.translatedContent) {\r\n      parts.push(`**Summary:** ${update.translatedContent}`);\r\n    }\r\n\r\n    parts.push(`**Content:** ${update.content}`);\r\n\r\n    if (update.originalUrl) {\r\n      parts.push(`**Source URL:** ${update.originalUrl}`);\r\n    }\r\n\r\n    return parts.join('\\n\\n');\r\n  }\r\n\r\n  private determineRegionalPriority(update: RegionalUpdate, authority: RegionalAuthority): 'low' | 'medium' | 'high' | 'critical' {\r\n    // Base priority on authority importance\r\n    let basePriority = authority.priority;\r\n\r\n    // Adjust based on update type\r\n    const highPriorityTypes = ['safety alert', 'recall', 'urgent', 'emergency'];\r\n    const mediumPriorityTypes = ['approval', 'registration', 'clearance'];\r\n\r\n    const updateType = update.type.toLowerCase();\r\n    const updateContent = (update.title + ' ' + update.content).toLowerCase();\r\n\r\n    if (highPriorityTypes.some(type => updateType.includes(type) || updateContent.includes(type))) {\r\n      return basePriority === 'high' ? 'critical' : 'high';\r\n    }\r\n\r\n    if (mediumPriorityTypes.some(type => updateType.includes(type) || updateContent.includes(type))) {\r\n      return basePriority === 'low' ? 'medium' : basePriority;\r\n    }\r\n\r\n    return basePriority;\r\n  }\r\n\r\n  async monitorRSSFeeds(authorityId: string): Promise<void> {\r\n    try {\r\n      const authority = this.regionalAuthorities.find(auth => auth.id === authorityId);\r\n      if (!authority || authority.rssFeeds.length === 0) {\r\n        console.log(`[Regional] No RSS feeds for ${authorityId}`);\r\n        return;\r\n      }\r\n\r\n      console.log(`[Regional] Monitoring RSS feeds for ${authority.name}`);\r\n\r\n      for (const feedUrl of authority.rssFeeds) {\r\n        try {\r\n          const feedContent = await this.makeRequest(feedUrl);\r\n          \r\n          // Simple RSS parsing (in production, use proper XML parser)\r\n          const items = this.parseRSSFeed(feedContent, authority);\r\n          \r\n          for (const item of items) {\r\n            await this.processRegionalUpdate(item, authority);\r\n          }\r\n        } catch (error) {\r\n          console.error(`[Regional] Error processing RSS feed ${feedUrl}:`, error);\r\n        }\r\n      }\r\n\r\n      console.log(`[Regional] Completed RSS monitoring for ${authority.name}`);\r\n    } catch (error) {\r\n      console.error(`[Regional] Error monitoring RSS feeds for ${authorityId}:`, error);\r\n    }\r\n  }\r\n\r\n  private parseRSSFeed(feedContent: string, authority: RegionalAuthority): RegionalUpdate[] {\r\n    // Simplified RSS parsing - in production use proper XML parser\r\n    try {\r\n      const items: RegionalUpdate[] = [];\r\n      \r\n      // For mock implementation, return sample data\r\n      if (typeof feedContent === 'string' && feedContent.includes('xml')) {\r\n        const mockItems = this.getMockRegionalData(authority.id);\r\n        return mockItems.slice(0, 3); // Return first 3 items\r\n      }\r\n\r\n      return items;\r\n    } catch (error) {\r\n      console.error('[Regional] Error parsing RSS feed:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async syncAllRegionalAuthorities(): Promise<void> {\r\n    try {\r\n      console.log('[Regional] Starting sync for all regional authorities');\r\n\r\n      const activeAuthorities = this.regionalAuthorities.filter(auth => auth.active);\r\n      \r\n      for (const authority of activeAuthorities) {\r\n        try {\r\n          console.log(`[Regional] Syncing ${authority.name}...`);\r\n          \r\n          // Collect updates via API\r\n          await this.collectRegionalUpdates(authority.id);\r\n          \r\n          // Monitor RSS feeds\r\n          await this.monitorRSSFeeds(authority.id);\r\n          \r\n          // Small delay between authorities\r\n          await new Promise(resolve => setTimeout(resolve, 1000));\r\n        } catch (error) {\r\n          console.error(`[Regional] Error syncing ${authority.name}:`, error);\r\n          // Continue with other authorities\r\n        }\r\n      }\r\n\r\n      console.log('[Regional] Completed sync for all regional authorities');\r\n    } catch (error) {\r\n      console.error('[Regional] Error in regional sync:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  getRegionalAuthorities(): RegionalAuthority[] {\r\n    return [...this.regionalAuthorities];\r\n  }\r\n\r\n  getAuthorityStatus(): any {\r\n    return this.regionalAuthorities.map(auth => ({\r\n      id: auth.id,\r\n      name: auth.name,\r\n      country: auth.country,\r\n      region: auth.region,\r\n      active: auth.active,\r\n      priority: auth.priority,\r\n      dataTypes: auth.dataTypes,\r\n      hasAPI: !!auth.apiUrl,\r\n      rssFeeds: auth.rssFeeds.length\r\n    }));\r\n  }\r\n}"]}