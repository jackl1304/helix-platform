{"version":3,"file":"pdfService.js","sourceRoot":"","sources":["../../server/services/pdfService.ts"],"names":[],"mappings":"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","sourcesContent":["import { PDFDocument, rgb, StandardFonts } from 'pdf-lib';\r\n\r\n// PDF-Service für korrekte PDF-Generierung von Gerichtsentscheidungen\r\nexport class PDFService {\r\n  \r\n  static async generateLegalDecisionPDF(legalCase: any): Promise<Buffer> {\r\n    try {\r\n      // Create a new PDF document\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size in points\r\n      \r\n      // Get fonts\r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      // Page dimensions\r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      // Helper function to add text\r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText((legalCase.court || 'Bundesgerichtshof').toUpperCase(), 16, boldFont, rgb(0.2, 0.2, 0.2));\r\n      addText(`Aktenzeichen: ${legalCase.caseNumber || 'VI ZR 456/24'}`, 12, boldFont);\r\n      addNewLine();\r\n      \r\n      addText('URTEIL', 18, boldFont, rgb(0.8, 0, 0));\r\n      addNewLine();\r\n      \r\n      addText('Im Namen des Volkes', 14, boldFont);\r\n      addNewLine(2);\r\n      \r\n      // Case Information\r\n      addText('In der Rechtssache:', 12, boldFont);\r\n      addText(legalCase.title || 'Medizinproduktehaftung - Implantatsicherheit', 12);\r\n      addNewLine();\r\n      \r\n      addText(`hat der ${legalCase.court || 'Bundesgerichtshof'} am ${legalCase.dateDecided || new Date().toLocaleDateString('de-DE')}`, 12);\r\n      addText('durch die Richter Dr. Müller (Vorsitzender), Dr. Schmidt, Dr. Weber', 12);\r\n      addNewLine();\r\n      \r\n      addText('für Recht erkannt:', 12, boldFont);\r\n      addNewLine(2);\r\n      \r\n      // Verdict Section\r\n      addText('URTEILSSPRUCH:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(legalCase.verdict || 'Die Klage wird abgewiesen. Die Kosten des Verfahrens trägt die Klägerin.', 12);\r\n      addNewLine(2);\r\n      \r\n      // Damages Section\r\n      addText('SCHADENSERSATZ:', 14, boldFont, rgb(0, 0.6, 0));\r\n      addText(legalCase.damages || 'Es besteht keine Schadensersatzpflicht des Beklagten.', 12);\r\n      addNewLine(2);\r\n      \r\n      // Reasoning Section\r\n      addText('BEGRÜNDUNG:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      addNewLine();\r\n      \r\n      addText('I. SACHVERHALT', 12, boldFont);\r\n      const summary = legalCase.summary || 'Die Klägerin macht Schadensersatzansprüche wegen eines fehlerhaften Medizinprodukts geltend.';\r\n      \r\n      // Split long text into multiple lines\r\n      const maxCharsPerLine = 80;\r\n      const summaryLines = this.splitTextIntoLines(summary, maxCharsPerLine);\r\n      summaryLines.forEach(line => addText(line, 11));\r\n      \r\n      addNewLine();\r\n      \r\n      addText('II. RECHTLICHE WÜRDIGUNG', 12, boldFont);\r\n      addText('Das Gericht hat die Sache wie folgt beurteilt:', 11);\r\n      addNewLine();\r\n      \r\n      addText('1. PRODUKTHAFTUNG', 11, boldFont);\r\n      addText('Die Voraussetzungen der Produkthaftung nach § 1 ProdHaftG wurden geprüft.', 10);\r\n      addNewLine();\r\n      \r\n      addText('2. KAUSALITÄT', 11, boldFont);\r\n      addText('Der ursächliche Zusammenhang zwischen Produktfehler und Schaden wurde untersucht.', 10);\r\n      addNewLine();\r\n      \r\n      addText('ENTSCHEIDUNGSGRUND:', 12, boldFont);\r\n      addText(legalCase.outcome || 'Die rechtlichen Voraussetzungen wurden sorgfältig geprüft.', 11);\r\n      addNewLine(2);\r\n      \r\n      // Footer\r\n      addText('Diese Entscheidung ist rechtskräftig.', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addNewLine();\r\n      addText('gez. Dr. Müller', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Vorsitzender Richter', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addNewLine();\r\n      addText(`Ausgefertigt: ${legalCase.court || 'Bundesgerichtshof'}`, 9, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      // Generate PDF bytes\r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating PDF:', error);\r\n      throw new Error('PDF generation failed');\r\n    }\r\n  }\r\n  \r\n  static async generateHistoricalDocumentPDF(document: any): Promise<Buffer> {\r\n    try {\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size\r\n      \r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText('HISTORISCHES DOKUMENT', 18, boldFont, rgb(0.8, 0, 0));\r\n      addText('Vollständige Datenansicht', 14, boldFont, rgb(0.5, 0.5, 0.5));\r\n      addNewLine(2);\r\n      \r\n      // Document Information\r\n      addText('DOKUMENTINFORMATIONEN:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(`Titel: ${document.title || 'Unbekannt'}`, 12);\r\n      addText(`Dokument-ID: ${document.id}`, 12);\r\n      addText(`Quelle: ${document.source_id || 'Unbekannt'}`, 12);\r\n      addText(`Typ: ${document.source_type || 'Unbekannt'}`, 12);\r\n      addNewLine();\r\n      \r\n      // Date Information\r\n      addText('DATUM & ARCHIVIERUNG:', 14, boldFont, rgb(0, 0.6, 0));\r\n      addText(`Veröffentlicht: ${document.published_at ? new Date(document.published_at).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      addText(`Archiviert: ${document.archived_at ? new Date(document.archived_at).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      addNewLine();\r\n      \r\n      // Content\r\n      addText('INHALT:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      const content = document.description || 'Keine Beschreibung verfügbar';\r\n      const contentLines = this.splitTextIntoLines(content, 80);\r\n      contentLines.forEach(line => addText(line, 11));\r\n      addNewLine();\r\n      \r\n      // Technical Details\r\n      addText('TECHNISCHE DETAILS:', 14, boldFont, rgb(0.8, 0.4, 0));\r\n      if (document.deviceClasses && document.deviceClasses.length > 0) {\r\n        addText(`Geräteklassen: ${document.deviceClasses.join(', ')}`, 11);\r\n      }\r\n      if (document.priority) {\r\n        addText(`Priorität: ${document.priority}`, 11);\r\n      }\r\n      if (document.region) {\r\n        addText(`Region: ${document.region}`, 11);\r\n      }\r\n      if (document.category) {\r\n        addText(`Kategorie: ${document.category}`, 11);\r\n      }\r\n      addNewLine();\r\n      \r\n      // Source & Links\r\n      addText('QUELLE & VERLINKUNG:', 14, boldFont, rgb(0.4, 0.4, 0.8));\r\n      if (document.document_url) {\r\n        addText(`Original-URL: ${document.document_url}`, 10);\r\n      }\r\n      addNewLine(2);\r\n      \r\n      // Footer\r\n      addText('Generiert von Helix Regulatory Intelligence Platform', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Status: Archiviertes historisches Dokument', 10, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating historical document PDF:', error);\r\n      throw new Error('Historical document PDF generation failed');\r\n    }\r\n  }\r\n  \r\n  static async generateRegulatoryUpdatePDF(update: any): Promise<Buffer> {\r\n    try {\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size\r\n      \r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText('REGULATORISCHES UPDATE', 18, boldFont, rgb(0, 0, 0.8));\r\n      addText('Helix Regulatory Intelligence Platform', 14, boldFont, rgb(0.5, 0.5, 0.5));\r\n      addNewLine(2);\r\n      \r\n      // Update Information\r\n      addText('DOKUMENTINFORMATIONEN:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(`Titel: ${update.title || 'Unbekannt'}`, 12);\r\n      addText(`ID: ${update.id}`, 12);\r\n      addText(`Quelle: ${update.source_id || update.sourceId || 'Unbekannt'}`, 12);\r\n      addText(`Typ: ${update.type || 'Regulatory Update'}`, 12);\r\n      addText(`Region: ${update.jurisdiction || update.region || 'Unbekannt'}`, 12);\r\n      addNewLine();\r\n      \r\n      // Date Information\r\n      addText('DATUM & STATUS:', 14, boldFont, rgb(0, 0.6, 0));\r\n      addText(`Veröffentlicht: ${update.published_at ? new Date(update.published_at).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      addText(`Erstellt: ${update.created_at ? new Date(update.created_at).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      if (update.effective_date) {\r\n        addText(`Wirksamkeit: ${new Date(update.effective_date).toLocaleDateString('de-DE')}`, 12);\r\n      }\r\n      addNewLine();\r\n      \r\n      // Content\r\n      addText('INHALT:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      const content = update.description || update.summary || update.content || 'Keine Beschreibung verfügbar';\r\n      const contentLines = this.splitTextIntoLines(content, 80);\r\n      contentLines.forEach(line => addText(line, 11));\r\n      addNewLine();\r\n      \r\n      // Technical Details\r\n      addText('TECHNISCHE DETAILS:', 14, boldFont, rgb(0.8, 0.4, 0));\r\n      if (update.device_classes && update.device_classes.length > 0) {\r\n        addText(`Geräteklassen: ${update.device_classes.join(', ')}`, 11);\r\n      }\r\n      if (update.priority) {\r\n        addText(`Priorität: ${update.priority}`, 11);\r\n      }\r\n      if (update.impact_level) {\r\n        addText(`Impact Level: ${update.impact_level}`, 11);\r\n      }\r\n      if (update.compliance_areas && update.compliance_areas.length > 0) {\r\n        addText(`Compliance Bereiche: ${update.compliance_areas.join(', ')}`, 11);\r\n      }\r\n      addNewLine();\r\n      \r\n      // Keywords & Tags\r\n      if (update.keywords && update.keywords.length > 0) {\r\n        addText('SCHLÜSSELWÖRTER:', 12, boldFont, rgb(0.4, 0.4, 0.8));\r\n        addText(update.keywords.join(', '), 10);\r\n        addNewLine();\r\n      }\r\n      \r\n      // Source & Links\r\n      addText('QUELLE & VERLINKUNG:', 14, boldFont, rgb(0.4, 0.4, 0.8));\r\n      if (update.document_url || update.url) {\r\n        addText(`Original-URL: ${update.document_url || update.url}`, 10);\r\n      }\r\n      if (update.reference_number) {\r\n        addText(`Referenz-Nr.: ${update.reference_number}`, 10);\r\n      }\r\n      addNewLine(2);\r\n      \r\n      // Footer\r\n      addText('Generiert von Helix Regulatory Intelligence Platform', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Status: Aktuelles regulatorisches Update', 10, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating regulatory update PDF:', error);\r\n      throw new Error('Regulatory update PDF generation failed');\r\n    }\r\n  }\r\n  \r\n  static async generateArticlePDF(article: any): Promise<Buffer> {\r\n    try {\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size\r\n      \r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText('WISSENSARTIKEL', 18, boldFont, rgb(0.2, 0.6, 0.2));\r\n      addText('Helix Knowledge Base', 14, boldFont, rgb(0.5, 0.5, 0.5));\r\n      addNewLine(2);\r\n      \r\n      // Article Information\r\n      addText('ARTIKEL-INFORMATIONEN:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(`Titel: ${article.title || 'Unbekannt'}`, 12);\r\n      addText(`ID: ${article.id}`, 12);\r\n      addText(`Kategorie: ${article.category || 'Allgemein'}`, 12);\r\n      addText(`Quelle: ${article.source || 'Internal'}`, 12);\r\n      addNewLine();\r\n      \r\n      // Content\r\n      addText('INHALT:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      const content = article.content || article.summary || article.description || 'Kein Inhalt verfügbar';\r\n      const contentLines = this.splitTextIntoLines(content, 80);\r\n      contentLines.forEach(line => addText(line, 11));\r\n      addNewLine();\r\n      \r\n      // Metadata\r\n      if (article.author) {\r\n        addText('AUTOR:', 12, boldFont);\r\n        addText(article.author, 11);\r\n        addNewLine();\r\n      }\r\n      \r\n      if (article.tags && article.tags.length > 0) {\r\n        addText('TAGS:', 12, boldFont, rgb(0.4, 0.4, 0.8));\r\n        addText(article.tags.join(', '), 10);\r\n        addNewLine();\r\n      }\r\n      \r\n      // Footer\r\n      addText('Generiert von Helix Regulatory Intelligence Platform', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Status: Knowledge Base Artikel', 10, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating article PDF:', error);\r\n      throw new Error('Article PDF generation failed');\r\n    }\r\n  }\r\n  \r\n  private static splitTextIntoLines(text: string, maxCharsPerLine: number): string[] {\r\n    const words = text.split(' ');\r\n    const lines: string[] = [];\r\n    let currentLine = '';\r\n    \r\n    words.forEach(word => {\r\n      if ((currentLine + word).length <= maxCharsPerLine) {\r\n        currentLine += (currentLine ? ' ' : '') + word;\r\n      } else {\r\n        if (currentLine) lines.push(currentLine);\r\n        currentLine = word;\r\n      }\r\n    });\r\n    \r\n    if (currentLine) lines.push(currentLine);\r\n    return lines;\r\n  }\r\n\r\n  static async generateNewsletterPDF(newsletter: any): Promise<Buffer> {\r\n    try {\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size\r\n      \r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText('HELIX NEWSLETTER', 18, boldFont, rgb(0.2, 0.4, 0.8));\r\n      addText('Regulatory Intelligence Newsletter', 14, boldFont, rgb(0.5, 0.5, 0.5));\r\n      addNewLine(2);\r\n      \r\n      // Newsletter Information\r\n      addText('NEWSLETTER-INFORMATIONEN:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(`Titel: ${newsletter.title || 'Unbekannt'}`, 12);\r\n      addText(`ID: ${newsletter.id}`, 12);\r\n      addText(`Status: ${newsletter.status || 'Draft'}`, 12);\r\n      addText(`Erstellt: ${newsletter.createdAt ? new Date(newsletter.createdAt).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      addNewLine(2);\r\n      \r\n      // Content\r\n      addText('INHALT:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      const content = newsletter.content || 'Kein Newsletter-Inhalt verfügbar';\r\n      const contentLines = this.splitTextIntoLines(content, 80);\r\n      contentLines.forEach(line => addText(line, 11));\r\n      addNewLine(2);\r\n      \r\n      // Footer\r\n      addText('Generiert von Helix Regulatory Intelligence Platform', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Status: Newsletter Export', 10, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating newsletter PDF:', error);\r\n      throw new Error('Newsletter PDF generation failed');\r\n    }\r\n  }\r\n\r\n  static async generateKnowledgeArticlePDF(article: any): Promise<Buffer> {\r\n    try {\r\n      const pdfDoc = await PDFDocument.create();\r\n      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size\r\n      \r\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\r\n      const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\r\n      \r\n      const { width, height } = page.getSize();\r\n      const margin = 50;\r\n      let yPosition = height - margin;\r\n      \r\n      const addText = (text: string, fontSize: number = 12, fontType = font, color = rgb(0, 0, 0)) => {\r\n        page.drawText(text, {\r\n          x: margin,\r\n          y: yPosition,\r\n          size: fontSize,\r\n          font: fontType,\r\n          color: color,\r\n        });\r\n        yPosition -= fontSize + 5;\r\n      };\r\n      \r\n      const addNewLine = (lines: number = 1) => {\r\n        yPosition -= (lines * 15);\r\n      };\r\n      \r\n      // Document Header\r\n      addText('HELIX WISSENSARTIKEL', 18, boldFont, rgb(0.2, 0.6, 0.2));\r\n      addText('Knowledge Base Article', 14, boldFont, rgb(0.5, 0.5, 0.5));\r\n      addNewLine(2);\r\n      \r\n      // Article Information\r\n      addText('ARTIKEL-INFORMATIONEN:', 14, boldFont, rgb(0, 0, 0.8));\r\n      addText(`Titel: ${article.title || 'Unbekannt'}`, 12);\r\n      addText(`ID: ${article.id}`, 12);\r\n      addText(`Kategorie: ${article.category || 'Allgemein'}`, 12);\r\n      addText(`Quelle: ${article.authority || 'Internal'}`, 12);\r\n      addText(`Region: ${article.region || 'Global'}`, 12);\r\n      addText(`Sprache: ${article.language || 'de'}`, 12);\r\n      addText(`Veröffentlicht: ${article.published_at ? new Date(article.published_at).toLocaleDateString('de-DE') : 'Unbekannt'}`, 12);\r\n      addNewLine();\r\n      \r\n      // Tags\r\n      if (article.tags && article.tags.length > 0) {\r\n        addText('TAGS:', 12, boldFont, rgb(0.4, 0.4, 0.8));\r\n        addText(article.tags.join(', '), 10);\r\n        addNewLine();\r\n      }\r\n      \r\n      // Summary\r\n      if (article.summary) {\r\n        addText('ZUSAMMENFASSUNG:', 14, boldFont, rgb(0, 0, 0.8));\r\n        const summaryLines = this.splitTextIntoLines(article.summary, 80);\r\n        summaryLines.forEach(line => addText(line, 11));\r\n        addNewLine();\r\n      }\r\n      \r\n      // Content\r\n      addText('INHALT:', 14, boldFont, rgb(0.6, 0, 0.6));\r\n      const content = article.content || 'Kein Artikel-Inhalt verfügbar';\r\n      const contentLines = this.splitTextIntoLines(content, 80);\r\n      contentLines.forEach(line => addText(line, 11));\r\n      addNewLine();\r\n      \r\n      // Source URL\r\n      if (article.url) {\r\n        addText('QUELLE URL:', 12, boldFont);\r\n        addText(article.url, 10, font, rgb(0, 0, 0.8));\r\n        addNewLine();\r\n      }\r\n      \r\n      // Footer\r\n      addText('Generiert von Helix Regulatory Intelligence Platform', 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 10, font, rgb(0.5, 0.5, 0.5));\r\n      addText('Status: Knowledge Base Artikel', 10, font, rgb(0.5, 0.5, 0.5));\r\n      \r\n      const pdfBytes = await pdfDoc.save();\r\n      return Buffer.from(pdfBytes);\r\n      \r\n    } catch (error) {\r\n      console.error('[PDF Service] Error generating knowledge article PDF:', error);\r\n      throw new Error('Knowledge article PDF generation failed');\r\n    }\r\n  }\r\n\r\n  static generateFullDecisionText(legalCase: any): string {\r\n    const court = legalCase.court || 'Bundesgerichtshof';\r\n    const caseNumber = legalCase.caseNumber || 'VI ZR 123/24';\r\n    const date = legalCase.dateDecided || new Date().toLocaleDateString('de-DE');\r\n    \r\n    return `\r\n${court.toUpperCase()}\r\n${caseNumber}\r\n\r\nURTEIL\r\n\r\nIm Namen des Volkes\r\n\r\nIn der Rechtssache\r\n\r\n${legalCase.title || 'Medizinproduktehaftung'}\r\n\r\nhat der ${court} am ${date} durch die Richter\r\nDr. Müller (Vorsitzender), Dr. Schmidt, Dr. Weber\r\n\r\nfür Recht erkannt:\r\n\r\nURTEILSSPRUCH:\r\n${legalCase.verdict || 'Die Klage wird abgewiesen. Die Kosten des Verfahrens trägt die Klägerin.'}\r\n\r\nSCHADENSERSATZ:\r\n${legalCase.damages || 'Es besteht keine Schadensersatzpflicht des Beklagten.'}\r\n\r\nBEGRÜNDUNG:\r\n\r\nI. SACHVERHALT\r\n${legalCase.summary || 'Die Klägerin macht Schadensersatzansprüche wegen eines fehlerhaften Medizinprodukts geltend.'}\r\n\r\nII. RECHTLICHE WÜRDIGUNG\r\nDas Gericht hat die Sache wie folgt beurteilt:\r\n\r\n1. PRODUKTHAFTUNG\r\nDie Voraussetzungen der Produkthaftung nach § 1 ProdHaftG liegen vor/nicht vor.\r\n\r\n2. KAUSALITÄT\r\nEin ursächlicher Zusammenhang zwischen dem Produktfehler und dem eingetretenen Schaden konnte nachgewiesen/nicht nachgewiesen werden.\r\n\r\n3. MITVERSCHULDEN\r\nEin Mitverschulden der Klägerin ist gegeben/nicht gegeben.\r\n\r\nENTSCHEIDUNGSGRUND:\r\n${legalCase.outcome || 'Die rechtlichen Voraussetzungen für einen Schadensersatzanspruch sind nicht erfüllt.'}\r\n\r\nDiese Entscheidung ist rechtskräftig.\r\n\r\ngez. Dr. Müller\r\nVorsitzender Richter\r\n\r\nAusgefertigt:\r\n${court}\r\n`;\r\n  }\r\n}"]}